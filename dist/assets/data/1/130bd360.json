{"data":{"tag":{"title":"statistics","belongsTo":{"edges":[{"node":{"title":"Calculating the Probability of some Event (E)","path":"/calculating-the-probability-of-some-event-e","date":"17. June 2019","timeToRead":3,"description":"How to calculate the Probability of an event occuring by also using the Z-score","cover_image":null,"content":"<p>Probability can be used to describe the relationship between given values and the chance/probability of some event occuring.\nThis post will outline how we describe probability of some event given a fitted distribution.\nWe will fit a distribution to then calculate the survival function using the z-score of our limit given a fitted distribution.</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> scipy </span><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> stats</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> pandas </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> pd</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> numpy </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> np</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> altair </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> alt</span>\n<span style=\"color: #D8DEE9FF\">alt.data_transformers.</span><span style=\"color: #88C0D0\">enable</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">json</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">DataTransformerRegistry.enable(&#039;json&#039;)</code>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">read_csv</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">example_parameter.csv</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<h1 id=\"maximum-likelihood-estimate\"><a href=\"#maximum-likelihood-estimate\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>maximum likelihood estimate</h1>\n<p>In essence we either try distributions until it fits the data the best, or we know a analytical solution for the distribution at hand and get the best fitted distribution of the data right away.</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">mu, std </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">fit</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">mu, std</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">(5.669365294764912, 1.7405441476684247)</code>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># x between -3 and above with .001 steps.</span>\n<span style=\"color: #D8DEE9FF\">x_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">3</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    mu </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">5</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #88C0D0\"> std</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0.001</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #4C566A\"># Mean = mu, SD = std.</span>\n<span style=\"color: #D8DEE9FF\">y_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">pdf</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    x_axis</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    mu</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    std</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #4C566A\"># plot</span>\n<span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> y_axis</span>\n<span style=\"color: #D8DEE9FF\">alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">data</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">properties</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">Probability</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 453 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-1'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-1)' width='453' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAzCAYAAAAn3w6xAAAACXBIWXMAAAsSAAALEgHS3X78AAASvklEQVRo3s1aCXhURbbuJenupLN1VtLp9N6BJIaQHUICCfhA3oCCI8t76sPxvYfjwiqDIApESAhLEAIIYxgCEpIgiwwEWQQlAypbAtnoLOybGEHFcZxNv55zLqf6K25uh2Z4n/PyfSe3%2btyqc6vq1jnn/6uuTPav%2bwsB0VLZh65yKgeAqDjdz/YnZ1JdXS1raWmRnT9/Xnbu3Ll7RKyTqiMlhw8flk2dOlUYkFwunwQyDWQK/FwI1zkgxVBehnq4lioUisFYd9CgQYrjx4979YwH7de/8g/fsBrEAmIF6QliIwkG6U26n%2b0Pl14vkHiQPjU1NUGwAkJhlkKYwIyihIHoqCwI3AuFayiVQ7iruy6vv3z5cqjL5Qoi0YD4gfjTVQ2ipat/Y2Nj%2bMWLF0P4fpCE8XZJQqkvfN%2bEuuL21C8NPwFKHDwsvwyciFWrVqXX19ebL126FA0N9CAxID2gUTZcY%2bEq6OAaCdcEkFSQCKrnrgsSC2VmQw%2b/sdzf6XQa2lpb9afqzxhdf7kU8n3nRUdjU3NqfX1dVHNzs%2bH06dOGpqYmPT3PwNpzfenP2cTf2I/eJJFUh9Xvz7enPuAYEjwuhwULFpik9NDQJKELwMFL6I3e2DCNW2OevHzPQJfrj0HePK%2bbfujw7T6ADas4AGq0Wq0f%2bmZxcbGtrKxMiMTwtuRQWQheMGt2KCsxwIDIyRAuvRi6r%2bD0dij7sLokqHdU7T2OK0725Bvv24fNqMp7fuHOYZOW12Shbs22I8qLF867n0c2eRvYHwfZwrKCnheFb5/vB4mDb0u2cAx2fgJ8QbLBBTDy5oML9Af/iwf/s%2bJAaDBWkEFQjgOxUefMIGnwG5eqiTqG9S1UtydXFwXLg9vaOxxff3nVPGXFngnHT7c4rl%2b91GfeugMzOzrOmak9ivA8GoCN9YP6MhjtcjoT6LLgmglXE3sePXswtXHrqF%2bPiFeFn0qlwiWkWbx4sbW0tFRYAZgO2QogQ1IrQE9lOdPTA9kKcNfHweN1xKxq/ROvb8nHssv1Y%2bDMd/b%2bMv2FcgP%2bXrv9qIJbcQrOBnuGnf9Nz47kVoCcu2%2bnlcLbUKDeYwwoKioyPkgMAKNdYgDoJG20ONsx9cnypmxKy/x1eezdCfjev/i9j5PSJpRniGx4HQMwsj9IDMAVLU6DceACuCySSkpKssAFzOACei6yR0Oj/hTZmR79LgF0qfQGDCwLoFvgJHB1hcjc3nEu509f34h6uWT30x99esbeeeNyxKWLFxIbW9oyJiz%2b/ehmZ5sBYkAMF8ENLOtQ5kFhkR3LBspGQhagsoHVRRvUhrXHdkZxFsAJSIQJyMQJWLRoUXJdXV0E5OxgLn8GQaMUyrdMH0BxoBeIlr0FkECsSznYbaO1rSP4y%2buXe0OgM/%2bq6IPHXa6f/OsanYEwaLvrx9ux/1mwfVjJ5k9sLtd3AVgX2qRQdA8W4ZFUkGAq430tF2e0LCOQpIraBpPbegZaCxcuNEdFRSkklpNFYinhxERJ6HFiuth2/eUr/eCpFZZ/e3VzKtM1tLQCOPopMPl/fmcDfSJnw%2bJh%2bUr1A8FRmDd1SW8T65QRERGYDeQwASYpIoKDkpoAFnzuV/euv/858rHfVGZDwHNP2tnWdp2AA3KKg%2bFeDjfhZg%2bdl%2bqHgEi97Yd4AnDgueACaXB9dMmSJbkQ/eMuXLhgxreOKYnSXB6lFkxzqMN40AfKfalsZXVBl0dRnNmwQJqzXLl0ccD0VR8%2bs6e2PrHzxhUTxASME2kXLpzPqG90mqeW7hnvbG23Qhy453nMBqXYPOoD6xsiu3QUKlvZfVFdC/UHU2uiGAgF%2bfn5IUXVQhrsdfDgwcBbt26pOjo6NNBAAw1UFPD8QdSIpeG3D0FLC4EPP9SD%2bBJE1rK6MHjA/Xd8P69rTh03b9sTgPXlgAH8CVjFwCoQ3tR/FGwbvnDjoTC47wP3EtEmXNXUB3ZNRB31QUOpOZYGr%2bT0aqqr4QR1%2bFyHxxhQWFjoKQ0aJXQYdMK9hcLv7jianT%2blIlNUN6ihuVWwMXDypt5ZL24wk2t4Wr5S/QjxkAaN3qRBhKZW4ODo%2b5alS5cmnzx5MvLKlStoVMciP0XfcE4XSMstgTJCKJclMPqGEyvTwfLGt6paueUP48EF%2biEThEFjlghEUOJs64jHtz5zzb6sl5ftzkNGCJkgnTKJjhN8RhpFfx1FdOxHHKHUQOqDjlhfGl3dgv0C6SVOgykwAZgaUmECMhsaGkzABnsQg0JhDA/zbjTpIkHiKT1GUL5FfRRIP1yW5CJ6eJsxLtc3YSuqa6eVbqntA9kgHAaI9ZFFJnacO5f8/e3rYVv2n4ib%2bHbNWLgf1t7ewXJ4NOVv1pdsrg96enYS3E%2biMtNHU132W094BvsV/8AuIIXMPLFBT0jwpaW7npGwEcSnsMHTKh69D4p7aDYodgH8U6SkpAi5H4CQbd26dSpYhrLW1lbE1YxxOTDw0ZYSw%2bthjA0SxmZ1MQP4CtthxxsF3fjCD7QjZ28RtrpQx%2bzSKohmHQGOkDd8ZnUErAhz7YkmH8LyTBTUDznxAmYjiuERqsPuO0Tt5RR47VJpEMFJOhChHJ4NEsLCMrKzOMbOGBukZWYi5manlIN1gXWdt8FSd7h%2b6Ixd9f4fcmH5T3K5vjU0O9sdNEmYljIwlTadbbMACox54939Ty2vrh34zZdXc1rbO%2bJEjBLbDCZmydhht2yQb0vteoI8Ik6DwRqNBndktUCGrPPnz/fhlosbPHAz7iYh6GtMJ1U3Zsw7AqgaOr0yYVnl4ZFChb5Fcq4uriI3MIK3bxoyvTLd9dNt/aJNHytFSxffsE2ibxGMlPEIVArx0SqweYwBxcXFlrFjxyql/Ea8m0rYuocUbGZUlf0Nnb457/39J9Il6obyaDJn4ntBAInzIWhG50%2btkN9vN4d0mHHCvfF1cmH3BGABG%2bp9fHxwIBGwAuJra2sDOjs7EQgx8MHAjT8HTJTE/AQgxMAGXxeQnhqWNoCgP/uOnrN12NGTzWkwMBUsbTWBJiUxPRPUU9y8fll96PMG/6fefH/oqQZn8g9f39BQXTUHfhL43/TsWGKOSgZ4SBIIEPFyDxASGCBIMtHhlOXLl%2bOOUBzEADMHPxm8tZHfMggqQGFKj1byf6Eu%2bL8d4e/XX1417vz4VO9ppXuevvXFlWyAujayaSUEl0r%2ba2g%2bC8zQ9W30lBV7nv7kWMPj33ReNaENrh/3wFvOBmKGdEpxVinYTGKm2JPY3YaIWYoMSZETTGG8//J1oePu331f2hAF6a0vBLkoDyjunuULiDBpedXhIR4QqUVCh3Ek1Ju6pLeJT4RkAwYMkDM6DLxA4SUN9YoOD5m%2bObXfyxtNrr/eipbazRHvKqVOWK9/63cfPf0gdBgnwVs6LA6CmAb7gQskwzUDJmAg5H83G6RlZr67rM%2bxTU8r7aykkAvE0kYmCmNydkCAVhh0zIzVe8dt2PVZeueNyzlt7R1iF8BUii4QCzHDBm5iApdJervq8Gwom0Fn5ZY/tsmXcIEM3gW4%2b/mcazKdQ%2bwC%2bOYjVSqVDq46yALIBgOIDaopqPBBUEU6BBQ9KCYoKAAKQRChJtYF//fdf/SM/9i5W0eAf6uQN8CAWJBiNvS0fYbgSAO8AU%2bMlL8G1Ljto5MB3926pqKAxwJfAhfkNNQOB27g%2bsECHl8XRUUM09HdwYjRWxZGW2Hh3dX1GVLinzdlU64nhkdu1MV/x8zdOjDp%2bXUR3rJBJF7eQnJxekR/j1YqlVjZtmLFit7Hjx%2bPAjbI2Bc7J8SlGk6MKowCIGODgXRmx84J0xpb2qKQ9UH073v39MelAVSYwQIW%2bW0QoTncVxRsnG5qDUc2%2bNvtR8dPLd2Ti%2b3O3GWO7BwyjbADsxFICBUlkHTsfhrXLpQ4Q4SYDWIMyIAYMAiuj8EEpJ8%2bfdoIabAHne1F0w5wP27XV08YPp52hcIZW8O6yAZbnO2xLtf3OpiAEYs3fZwK%2bT%2b0vaMjm3Z02ZlhBG18JBNN1UOM0P/tzhfh%2b46cHjZ5ec1oyByh4D7sXC%2bazgyjRTaSSCI4%2b%2bK60dR3dJVu2aCn/XipNBgotSfIszBAdZDORsi7sREi5UYAjGzDZlQO8XZPEN%2buN332hBD5XWHTA2xG4pLrMgHwpoW6xnFrAiH/D%2biuQ7TFHd51A/VOJHCCXEiJ4V68CFzi//QEoAukgQvgUdUQdjwOLhDNH4zQGWB3ByPu43FYxv0B0UXOKTuQO2vNvqEu1990EBPY0XYMd9iB7R5BN2I2cBME2GIM0OG0t9YfHPTaO3sfdbl%2bCIUVYWCHHdzBSLfH43SIEiM6YseMkyAOgnqFQoGgwVBSUoJBELfEgtkHBbRpkcp9cKCjzRALxQEtt20V5GxrT8OPHf67eOfjCzcessJk4GGHcFDBHaAwG%2bzAMoBtdcEEBt%2b8djl57fYjxucX7hzlcv1d29DSqqOtrlTuQwhmw0ESIPowI1XiA4mwbg9GgAo/dBq8fuWiQZa7SDlg0qb8%2b21SekqDwBkEV8ybDDZ6/EZ1HxsPnQbDiQ1GAhnqeeDAgSBggwgc/Gi7W0VbzFoCH35sW5yQlpIAht/Rk03qn/540/bKst1Jz8zfLvj/kRNNWgJJiWz7nGz7UFQ2E5Njz1M72zqScPt8fOEHWeOLPkhBO5/VNftT1tBwdX0IlcZS2Y8DZYlUT8OxVeyLQxwDsuj7gAFr167NgjTYE2KAiYOPbjZIsNhCD0TfzSIUJtRtdraZv/vqWl/w3fHluz5LAUobC0vaQoPMI1jqtkFukUGMkh1imDoATt%2b%2becW04%2bCpRDww%2bft3N2Pw0IQguZk77DCwgxHeBoPv/MFKt2xwzJgxckqD5gc5GpPKAoDl%2bzw%2bq/oxL1NpiAc0aebIVH7Cc2U6%2bsbA4iEL/FNsUJIOG43GhzocfXHprhGQ/y3esDMKbBHdPQ/p9NDplUI8gWxi9/Zw1NMESJ0NYhrEg8mclStXZjc2NqILsLM3xgbzGRsknZGOsAU2iBudgOBiK/YcSyrccOjNv377hQn82ErMkTGyfHIjtw2Cq5nkUjb2PFYXEKUN9wdfXfnhrwAeZ37beS0bJ4HZpdScQWLk9Cj5jKVyfejCBvFtx0AaxJk1QhB07N69W3vnzh0fZHDAztTH6lt8gMXFw4P9Tp45qzrVcFa9/eBJJQy6BxAcC%2bR6JQYsgL4%2bI2dvGb37cF1f%2bO0L7VTEHlXEKOMZK6OrnDBGLJXZPR9Wt77JiVv0ytfX7g8aPWfrOMADwo7u7k/qNEdPNWvWbDuigLRrgDRrAPaoAC6hxj7XNTpV0OeEprsslO%2bDpls2CC5geW78f3XZFL3z1TVjV7SGHzv%2bEHLXTysD/31G1cisFzcYXD/eji6prFV6uaEZ6gFOW/Fsgv8Dt4oC93oh55X3dPf2409BwDWCxTa%2bk%2b5zlxggnA6rVCoMIiEAhW3TZ8zET1llo2ZX%2b4FE5E7cqKvaeyzj2be2RgA%2bDx81e0sP8MvoGas/TJ9btj8vH%2bguBL0RT87eEnnXT509T3x%2bVNhaLysrk%2b3bt094UFtbW9ypU6fkY8eOldXW1gqB9uzZsxFOp1PYKfr000/lu3btEuripsyOHTuEWNS0o1A2bk6VUN62/1jmL16rGjZ8ZvXgJ16vTuj30gZzUflHqUs3HUrq%2bezakKfe3BIGfQkb/lpl2OY9n2UNf3V9ILZbvLZKsDtr1iwfyc/k8CXiJMME5GyqqLCuWLbUNHP%2bsj6TC1YPmFSwun/hyo2jXi1cmztx3qoBrxSsGfzCnDVDJxWWPzOteMNzk%2baVZpYumW9aCVIwv8i%2bYUN5DrBKB2QUW3FxsR1s2vHrs4qKiv7w24GTjPqCggLL%2bvXrk8vLy9OgbF60aJEd9QsWLLBVVlZml5aW2sAG6mywMu1Lly231%2bzcll62osgwraA0a8Lcd3/5/Bu/fXLm0veeemPZxhEvz12dM6Vgde7kglW5U956J6doVcWoeW%2bXJxcXLbBhH5YsWWKtqakxVlVV9epyNAZ/%2bMbke/fuVdBHzH6iQGHkPm9nf/hNgRB9jXn/K%2b/R71nhrfr7%2bxu5T%2bLdp9AajSZO/GBfX18DrL5YsV6tVifS5/P8n79KrclU%2buvUIj2uoBiJT%2bDttO1/D/UPDQ3V3e/T%2bSQ5DWDYpDXy2MRs8Gd5uso/SNAl5I0TlqNS5a%2bXK1UWGrRMq9Uy/IB8W/j8NTg4mM2wL%2bllycnJsoCAgC6dRx1now99Pe7WQabyo486hZeTMvwlIc7Ilb4W%2bIdfmcsyRk6Ul7a7ZI6%2bw6GP8ni5QumOA0qlEl8g7k51nQDooORswBv6P/00HToho8GwaxCIjtf9f/iT/wx2%2bdWS8gDPlT/kOATdPwDnyOBtBBGf4wAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"453\" alt=\"png\" data-srcset=\"/assets/static/output_6_0.e18b67c.f9b7b8a.png 453w\" data-sizes=\"(max-width: 453px) 100vw, 453px\" data-src=\"/assets/static/output_6_0.e18b67c.f9b7b8a.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_6_0.e18b67c.f9b7b8a.png\" width=\"453\" alt=\"png\"></noscript></p>\n<p>since we have now fitted a curve around a mu (i.e. not around 0) which is the standard way of showing a distribution.\nWe will here demonstrate how to calculate the likelihood of being above a certain value based on the data that we have seen using the survival function.</p>\n<h1 id=\"2-probability-of-the-survival-function\"><a href=\"#2-probability-of-the-survival-function\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2. probability of the survival function</h1>\n<h3 id=\"is-the-1---cdf-where-cdf-is-the-cumulative-distribution-function\"><a href=\"#is-the-1---cdf-where-cdf-is-the-cumulative-distribution-function\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>is the $(1 - cdf)$ where cdf is the cumulative distribution function</h3>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># plot</span>\n<span style=\"color: #D8DEE9FF\">x_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n\n<span style=\"color: #D8DEE9FF\">y_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">cdf</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">x_axis</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> mu</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> std</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">parameter</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">1 - cdf</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> y_axis</span>\n<span style=\"color: #D8DEE9FF\">line </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">parameter:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">1 - cdf:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">properties</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">Probability of being above limit</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">vertical_y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">2</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0.001</span>\n<span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">vertical_y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> vertical_y</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">limit</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> limit</span>\n\n<span style=\"color: #D8DEE9FF\">threshold </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">([{</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">threshold</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">: limit</span><span style=\"color: #ECEFF4\">}])</span>\n<span style=\"color: #D8DEE9FF\">rule </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">threshold</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_rule</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">color</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">firebrick</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    alt.X</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">threshold:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">parameter</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">line </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> rule</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 447 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-4'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-4)' width='447' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA0CAYAAAA62j4JAAAACXBIWXMAAAsSAAALEgHS3X78AAAU%2b0lEQVRo3t1beXgU1bKfmWSWZJZkss6aWTKTZUJCIEAIEPbnckXkouJVEYiKCBoiBGKIEMISwhJEQJ8k74qIhBBEkMUo4BUEgURly54MRAwCAkL0Id4PlzuvqlOddzLp8cb36T%2bvv6%2b%2bc7r6THX16VNVv6rTIxL98Yc/UJgAXwIkA1J58fFcyoz5d4eU5Iio9f/DNBeLxVwzZswY0deXrohuffu16PUdR0VjcreJ/5JTLn44/x3xX%2bdv5/rIu%2b/FjvaRgh1ia8rdftwT%2bPm7QM4qoCdB2iJRB%2bUDrQVaCvz5QAUSiaQXnOdBfyLQDKBlcL4Y2mehnQvtUGhfgzYX2ixoM0HePGgHwvnr0D6NLchJxvsmJiZKzp07Jzp//nyPCcf/WQfOZARQPFAskIv6Vlod6XTdCaQEMtIYC5AZ6BGgKKAEIAeNw2t2IAWd66hV/FFKS2FWDajk6NGjI2%2b2f6/5/lqb%2brV3jkTAm04G6v1AXkWfsfO2cX1489gmQ4v8XtC67p1bZn%2bqeL91RXmVw%2bPx4IOJoBUDyYD8qQ0AkgIFUqsEklNfRn0JkIJ%2bw1%2bTEynpnJejamhoCGptbdXAWw0i0nhRsAAPx8m62K5MJsMJiHnhhRcGHDl61PX9zev6vYe%2bsIydVxGTOn2TdembH6Vnr69MSc/cbL9/3rYYmAAnPHzsis0f3wNm0evenPKUSUvfHTX31coJ%2baX7sws3HniufN/RWM/3X0ac%2bOyk7eyZM4bGxsak%2bvr6fqC0/uzZsxY4j4LWCOfptbW10UDmkydPWurq6ow1NTVxDfX1g2rb2nSfbd0ad2j27EEXPJ7ImlOn4pqamgadOnXK0NzcHAUPYoblrIN2AFAc9A3IAzIBWYCGABmJx/FhjBUoXnApvPLKK5GTJk0K9OZ7PN%2bF4cx349%2b5bvbmnalrClr0xsG%2bA6Zvujttxlt2nv9l63kN3LibkwRelLdNwrn0nNuN5iH6T3B42/39TdivP3hQhg8kIEMPpBDgW4SeE2REC05AcXGxccWKFcHcjTe9I87bsJ/zzg1NLaaz9U1a7D%2b2%2bF2xSPa8KPf1D8WNTS1oiyJYJeLnVu/1I%2bEwWbe5sbBKxox7qQLtWXSqpjG89fx5PY0Rg3JiUjIazqXUF9N1JUwA%2bg3RB%2bnpqj0xMTbsN33%2buRKuWb1lQB9Xg4bnU%2bsH5GDG8g7QD8jRxXHJ5fJQDEvZ2dn2kpISbgKqqqrQu0pIMVxqIdSXkEBsY1AwKsKPBV54bUOziRc%2bLq9ifP9pb8Kk3NLgRPIyGNkOIDl5aJ6nggngHvrAvfeq9yYkcCup%2bYsvVHDNxujBj7cABdH9ef38oXUy9xMT%2bfMT0%2bkE/fz80Dunz5gxY3h1dXXypUuXbG63GxVzkvAhQH3x5qgwCsBr0I7CN0gP4ST76g/8tMbmFtu3V9rsHx0/22t68Z5n2i609oNraTTGSYTyRgLF4bJEuUB2OE8EGn7hxg1z7Z49SccXLhz%2b9S%2b/mN1NTUlwfTiuAkYG2vpQaJNRHumGOuHLQf3spB/PR1/Rq8vST01N5Wby5ZdfNixYsEAjYDPoXIJ6YkvAC4EbRGLf%2bUQJtxzTnnurFzjR0eBHhGSj0n5evABYARgORbtMpsBdRiNny40nTgSgcxOQgU5P5cUT42QKjOXMzsvJebi2qKjIDJPA2e%2bxY8fYZYo30HotJ1xqTiETQKfE2WyzW3Ljm4vcJExbuXty1al6A%2bfMGlskzHh86zJejrcJ7L/rLvVel8vGmwBOmLcJkMcP4v0Iyeo0ARzH83GyvX2AaMSIERKaAP20adMCBWYtEh2TAN8qwMM4283bA5rsN7lw1wCB8ai8N08GE8D5i/8SieTbFYqOKPCPf2AUMAnI0OOq6Yl%2bQitXCrAS4efIZ599dij4gETwAWbwATayUYydA4F6kzO0kQ3iteFk0%2bzYvhiXqW9zA12%2beMFYfbohbfEbB3OvXW7Tt7g5u7SRvGGMr7FRWHSh3/mqvd1Qs2uX61heXvolj8cAPgD56bQi2XsOQrsmXGAjnaJJvyhGZwv5sIQuUUChUKCHD8rPz3ds27ZNh0gLgEogDETyp2WKsywFAYFAAdT2wvjLn%2bN1AhuohD/xAvcePglI7iftSyX7n5hUuNMO8v1O1zYp4Tq%2b0QRoEaHxcpAXCisgDpHh8fz8MIgEXL%2blpiaMHGanbNIPHV4ErhzOf3TopKJJkdNY9B8K9BU4XhAHrFy50gCT4MsJan6vE%2bzqZ%2b4o1277JGXQc2%2blcYyRq8Q9coIGQxcnKARuaNJ77AR9AiGYAP306dOVAogq0vsGxLcK8IKEEF9Lizvo6qWvQgE0DRelFfmxaI13fgyv0wdsBB/wTmBghw84dAjfpskHEgzoiX5CL84fcACmlpa5c%2bcmHThwwN7e3h7c0tKCyy2cnFoiIbZgfDh0cngNCG09lD%2bn6zG4rOl34RQVgsHzx3l%2b/tb%2bzMrdo%2be9/mGqx/OLuqa%2bOQSu90PzQjkkW8vZrdvdF%2bxefWrjRsvhqVP73oC%2bu6EhinxMp2zsk3/ClaRFXdCE0HEjJkEAR7ww0hUdehw7AX7%2b/v6YuoYsW7YsobKyMhYmIAwmQIczy9njuXN96MHCKPlAIToCNngjHfHxBvHQT6IH0tG4MHB88e3XLroK3/woJnPNvglgEsGQN0TAtVRyZGjDOpowG0xA/4t37mhPb9liP/L88/2vejxamAA7Aa1Qeut6eqgU8lNhpAvqZyDnHc7rR7oafSZDy5cv1z/99NOBPkxA2VMTEAqDEA00YAYc/z%2byy%2b4SiQL4mB/lHQbZZKgEkyGZrMMEPvpI9hsm8IckQ4YlS5YEMQL41shjbYYnYgEFw%2bfePDOm0znCkueA0JjcbQPH5lVwDqqx2Y3hyt9L8UCYAE55yAOU71mt3EQ3VVcH8g/FyqZwqvaSIemG%2bP4XKHUBQhKpVIqzHZmTk%2bMoKyvD1FcCuTvOtpzQE9pXBKEvGfeGOhIYXO5S4iGJyZ6j6EZyno%2bTAsiQU/7ZVXscjxTsGEGZpovL/jrCJo7143yJ282huCOZmVrICLmw1XLmjJYwg5juz%2bsXTWYhIRlSCqnxJE9G4RX5Ch4hssnQIGgHzpw5c8jx48d7X7582QJACIVG0xJFoJGMqI0Ahp1uOpImx05OEsemoO1RP5qok/9l63lzXUOzc9a695%2biCDACKJacWDSBGMQXQ7%2b6edNUs3t3r%2bMLFgz9%2btdfTQCEOD7KIz2iqT%2bE/I6FZNgJpo8gAITj7KQrYoYEQRNYvXq1LjMzUyVgMzqhMMjjci8eRoJwHxC5k3/3nK1Dgu5fq/Xcvqovq6ySeI2V82FwM4TBHRoNV3hp%2bOQTfOtmHzglsKdQmDcNjMWzqBjZmQytWbOGS3pOnDjB5ttmPhni821KMJwELMTMWAxNBmYsn7Cghzbw93pwwXbXXdllfTz/umn8pLpG0drqox5wzz2C9QBWNlsPIDMVkUk52RoGUyfo9AE5QH15PFBYWGgAP%2bBrBah7ugLYN%2b3Fj%2bDPox8vUQyb%2bfbIX/77G8Pb71f5CawA7sWUi0SKd0NCuH7j0aMIcc0Cb9ToYwXY/l0UQFswgg8YjD4Aln86vHksiFixIELFBbSxwdDvQ/bpIDvDayMZ%2b3eQDfaj%2bGshnoN8RwrhBktTi9v5w41LlhfWvj/xyGe191%2b/0uZ0dyRI0ZRHoK0Pu3DjBvqARMgHhoEPwIIIArJhlEGy%2bqVDvzeTBNmpIDKSL%2bIw/Fg2GcIkSBYUFIQwUrp48WJraWlpKNYHamtrpUytDh8gjDyulJaXlKorfrSspBSaIvlYTWNYPvf2Ko%2bckmN734vlKesrjtyPJfTdH5/0pyRHzMFpeAE45nBGRlBlairXbz59OohfvhR9pEw%2boeVLXuT55eRcJaSDP%2bkq500Dl90QIA0DhEzgBzhbAljcWWCkJRbMJxPeOMAr3iMy0wnE6lC%2bULJ53wlObp%2bpG0MK/n7wmY67B2NFmcUBnAPb17evcnd0dAcO%2bOwzwaIo%2bSg1i0fIRzlYHoMPHIJRYNWqVbopU6YIIcGI34EEsfwd6oPfDSE%2bvvjdv4pET4p9IcHXEQlKpZ1lcXwZfzQSRByQCm1ydnZ2yqFDh2KvX78eAbmAgTYa0KtjAhJHYMhANzQQPtATz0ARIIEKlOG%2b%2bBglsHLs8fwctPiNg1NWlx3u7/HcDG1sbjGSqUTDBAy4%2bOOPoWfKyx1Hs7JSv/F4Qt2NjdGUO3SRDdSPbJ7Vz0T6RTI8Pa2WeG8kiDMVnp%2bf79q3b5/t1q1bgNtbQmjZqskp2egthhCFksPT8udU2HAQQlQTL5R%2b5yBkxvEBDCHilIM5PDh7feVY7J%2bubQqjXMIEE5B8xeNRniwpMR%2baMiX5O%2bi76%2btNNIlquj%2bvXxIfChFykz8IJ8cbzOjM8%2bN81gMgEggtdZ2PeoBNgCcIhKhO0I1/4lQ9brPd56se8BYCIbW6AwgdPuyrHmD4PfUAoRyBOwAE6efNm6f2YWNCFSGhigvOcoSADK1gpeiXG/rx87ePHjhjUygzVsFXhHZAhNqp03H9xuPHsawVJYQDvH0UOWC7wNhuPgDrAcjQZ2Vlufbu3avH5djUxNXsVFRnc9JN8A0oKXlR0dLDDI0/lxPut1MComL4ZorFKI/jH/uiLsDzw1VHzmsfDJi4dOdgTMI%2b/bwukKsJuN2uOx6Pf1VhYcTBBx5w4Y5xS21tBBVMZaSbivqxVHvAREdJtUINbbAEkH5Kqg0iP8a7IpQCbS%2bYgLRPP/2015UrV0wAhKwYcghnp2JViDYgrAREsB1GD8yfGylp6k8FCV4GhtFOPiUoSKavLrQOATDkylyzb9K3V9rMzS1uM/mKwV99953u7M6d8cdyc4dc8nh04ATj4beD6T5Wko/3SaMqFL8rHEUAbRg5PSvDj/auCrMmEJmRkSG4L9DTMEglqjABvkaoUFLX2MLJGJb19hDHxBIu3zhZ0yjjw%2bAGr4KI0O4wVax7HAZ9%2bgBwgqbi4mJOiSNHjrC7Peh9tV47rZ3JENUBxEzSo2d3ZOimnckQ8SW0e8Shsr/klNvH5VUM5hzjyXoNnwx9OGqUak98vO23NkfZ3WHSRUTlcidTBOF3jPy8N0fFgYGB%2bGP/3NxcC6TEGh8VoS5IkG7iYMvNPOLjkSD/TQ7xQ/hKkRff3n7ton9HpaiciwaX2r4M6KwIJSUp37PZ2IqQVUBGJxJkeBLe2bElNyEkiDtDw6EdMHv27MHHjh3rc/nyZdwdxrfrZL606EtFCyezGzyK2dV1km1zu8PsDi71ETMM4vk0HuWNxKqQx/O9YX7J/odWbTk06tdb38Q0N7eMgGQoqnN3%2bOefo3B3GHd7vGXzu8O0W%2bQkZxtL%2btlpnO/dYaPRiEmF/9KlS80Ah7lcYMeOHezHBiZmBfAmIGY%2bQGA/bsAStJ5ZjmImRxD8QOJsXZOMagSau%2bdsvRt3phoam7kQVpmWptrtdFq9P5Dgl7WACfBv2o9JnFi%2bxNsEOo8VK1agD%2bAeFCCxmLExE1MQ4W1MQrPdRRmq7evZnWSGbxDgO1pbz8v6PrORO79n7tZhgAxdnjvXOBkfjhiu2hMXx38hIrg7TGU7DfuCaAKcjM6%2bd4f5Y9myZfonn3xSKAoIJkNCJaffmwyh8nwW2HE8Jv1bwY6HPD98o%2buMAv/HZEjoWwKhKIA%2bANNiG5hA74MHDyZCMmQAH2ChQgYKH0A4wEiYm4/9Q6kkHUVjDRTv%2bxE8tVBhxEAFC34XyEKE%2bCCdCipmSJCsHs%2bdUEiQHnml/PAT%2bEHFiW07Eo69mDOYcEAc4QADIwNDIBZhXYx%2bZvIvQ2nThdfZTD7B1SUZksvlCFFlYALRFRUVJvxWr7m5WU2JBqK4WBKkIB4uRTVtSSmZcwW/BU2okZehoOot/z0Qz0dom0QwmZMDDlHl8Xynmr3u/czZbx61ejY8r3r/4b8lQTIkAyQYSVmlgpHNl%2bf1hPrUhD6DaNIDGZ6S%2bLG%2bTMCYk5Oj7r6x2aIHaNwtF4BV0g1rw8RpYXyEAB/3GyMFZNuqq6slXXeSb8iOVp%2bNSc3aek/G4wXOr0UizqRqDn2sOFvX2M3s6hubTCfP1HVJ1h6atVbc0NRs/11AaN26dZGFhYXdsr6bN2/qfvrpp278q1evdlPm9u3bwe3t7d2yvh9//DFIiH/t2jULlsRYXvs/PQrPv25zk/Vo5oYHsh/OHi8qvBLo%2bfYmfkUa3n3r/Z8R%2bLVpN/5Pt0xCz9nW1tY1GYIjEQu106dPTwE4bCkoKFAvX75cCxEhZOrUqUpIkBIhLNpmzZqlBrSohZUSDOEy5MCBA/2XLFkSDKajhXMt7ins2rXLAePjp02bpsTf4/iZM2eq4PfId/F8HD9nzhz1/v37%2b23YsCFi0aJFQSgnLy9PU7Zli3Hfvsq%2bE/My5R88NS504cSs%2b8bll4/NKHh70gvF27MefPHNMRMXbBo5acGm9IfmlvQpLNk5Zk7x1mGP5pYmT1nwRr9J8/%2beMnXRpv5Fpbsezpj3qn396mVBy4qWa%2bHlBsPzhVVVVXXxAX70BXccKJqwefNmRIORaA4wCUiR69evj4XWUVRUpEMetPhBpREeIgnODXiOfPiNDnhOeOg47NPvOf7atWuj4cE7%2bfQbHfAS4Tdm4BuIr4fWCoq6QGldYdEKc%2bnq/LCKV%2bYG5xcWx7xUuDZ17pJ1jtwlaxx5S9dE5y192bKoaHVywfI1cXlLVlvnF75sQ3ppyaropSvXpqxY85qxaFmhkWQb4FmM8Hzm3/p42kVfcbNHNLuBwk8cUG%2bB36voS3HvA%2b3RIMDHz%2bADBGQPFRhr8sFPJvnexwCvZ0HAN5aq4UwYkHT4oDt37oggLwhWqVQcFhg7dixnmxglAgICOCA0YcIE/ApclJCQ4KdQKMLHjx8vLisrE02ePJkbq9FolBRVRI899pgYTIjjq%2bEIDg7uhjFgfDffYjabpSADv1USLVq4UPxMRgYnQ6sNCZQrFPrFq14Vr1pXKs6aM4/jg25hcrmCc7wTHn1CvGX7e6Kx4x6UBCqVIXBbDr%2bUlpaK0tLSsPxngGcM%2bK0/TvzZh5r%2bFzABv56jNzIeaDJQBuIR0f/Tg59dhNpjgDD1HURbcwPpfCR%2breY1/k85/gckKftakoh%2bIAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"447\" alt=\"png\" data-srcset=\"/assets/static/output_8_0.9e473a1.c8eecf9.png 447w\" data-sizes=\"(max-width: 447px) 100vw, 447px\" data-src=\"/assets/static/output_8_0.9e473a1.c8eecf9.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_8_0.9e473a1.c8eecf9.png\" width=\"447\" alt=\"png\"></noscript></p>\n<h1 id=\"3-take-the-z-score-of-the-fitted-distribution\"><a href=\"#3-take-the-z-score-of-the-fitted-distribution\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>3. take the z-score of the fitted distribution</h1>\n<p>Since each distribution is centered around $mu$ we need to center our limit value against a normal distribution.\nThis is where we calculate the z-score from the distribution.</p>\n<p>$$\nz = \\frac{(value - mu)}{std}\n$$</p>\n<p>which says how many standard deviations we are from its $mu$.</p>\n<p>recall again that we want to see the probability of somethign accuring above the limit value.\ni.e. what is the probability that we exceed this value</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># set the limit of the measure</span>\n<span style=\"color: #D8DEE9FF\">limit </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">9</span>\n<span style=\"color: #D8DEE9FF\">z </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">limit </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> mu</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> std</span>\n<span style=\"color: #D8DEE9FF\">z</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">1.9135594519085861</code>\n<p>since we now have center our limit value around the $mu$ we need to apply the calculation for the probability given a distrubution that we assume with this calculation.</p>\n<p>meaning a $\\mu=0$ and a $std=1$</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># x between -3 and above with .001 steps.</span>\n<span style=\"color: #D8DEE9FF\">x_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">3</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    mu </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">5</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #88C0D0\"> std</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0.001</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #4C566A\"># Mean = mu, SD = std.</span>\n<span style=\"color: #D8DEE9FF\">y_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">pdf</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    x_axis</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">1</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #4C566A\"># plot</span>\n<span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> y_axis</span>\n<span style=\"color: #D8DEE9FF\">alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">data</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">properties</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">Probability</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 453 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-6'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-6)' width='453' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAzCAYAAAAn3w6xAAAACXBIWXMAAAsSAAALEgHS3X78AAASTElEQVRo3s1aCVhUV5auV8VSyiJQ7BRQVBWyiBg3VBYX3CISbSeJOslMOl9/M2YzqETRJG444q4wLBo0CWrYRI2JoqLGNdFEWnFhKaCMigQXTBu1O9N2Mt015zzOrbk8XmExnS899X3nu7fOO/e89%2b6797//OfcqFP%2b4nweIC9UdqBSo7grixOl%2btZ/AZOPGjYobN24orl271kW%2b/fZbsWxsMiv%2b%2bse7ilXbjwsoPz26I%2brk2qCcOnVKMW/ePPGFBEFIA0kHmQt/V0O5FGQN1DehHspcpVI5Fm2Tk5OV58%2bft%2bnXlrDn7E7%2bkT/8ws4gYSB6kAgQA0kfkFjS/Wo/HHqRIDEggzZt2uR169YtT7PZ7AE9JQr0KIoGxBPrpsZmT8uf2903FJ8MXA/y8%2bO77jACxGtkb7Vl7bFsaWnxslgs7iBuIGoQZyp7Ud2Fyt5Xr171hpFofQZONLxfEi/478X9t9ry70B1TxA13wEq7AAYftgB/XNycuKuXLkSCjcPAMNAaBgEpT%2bU8SDBqGtqNgf9/PiOd0bB4bmLtlQtsTy5r2lsNmvhWhDYiLZQD4YyACSQ/KC/BJPJpG1sbAyCe2hramr86%2brqYuvr6wdevHjRD%2braS5cuaWtrawPJh5baMkH/CUxH9/MFiSXxJRt2zwRJe3wGfIcom8Nh1apVIXJ6aBzaSRG8yOX1DfuffXdLVYpiyEoPia19PuAHD9MHR4w9trb0bLTJ%2bJb1AXp9FxA0Go04EhRr1qwxbNu2zQmGoQK%2blACOBWpkBHHI/PCYEv%2bPmVscsWTrkbjVO46PSUrbKc7Zov3nVLwtghG2J0F9OJRK%2bq8kWx%2bQAHoRdg3r4aBXce0F%2bI%2bCekHiww/qfswHuy6xZX7Rp9HmCMjKytKpVCqlTK%2bF8f/j39oRByuAsejzc5Fxb2wfIrHVySGt1AfpcF762GNLLyjnA%2be6l70%2bQG/g/%2bPLBsBLB0GpBQyIPnPmjFdbW5sLGLqCuIH0xjmGw7Wm1oQA5jRj2e5x5VXn%2b//%2bckP080sqUlF34UqDO9hZbaF0AUEfrlTHeeqGOiwRjHBIgxig7kz3QnEhH%2b70DEyw7QDmk2zRRxgK1d3ofigDWFuuDT5XX74DHEEGAwgmQDkqLy9v2OXLlw0AgghAISjQQAuShF/21s3r2otXTfo3N%2b6fAf/7X6lvHP7Ghv0vwiqgu379W7QXbemhEAiZj2DSh3L6QHqhwTgNOFutjC27lsR0JNhuIArzQRJMz8zahRAAYkdFdzcFQmwMGw5QnlOOeGvHKIvlZzWsAB6DZ30cFzxjs6sd4CMLgjiEewBgcj4QBD3t9QG2nUEQvr5i1qxZAgPBLVu2iHS0oaHBCoIIHDDcRer6UuYer3HpxUnIBSyWJ56j534SP3P5ngDuBkYQB2JdDJBEYCOQUnB%2bvfEr8iDIfICd1ZaTcM6vFQRBfKmdQNcY6DLwtA8EsQMKCgrEDoD1udMqUHmqRuyAae9XhMMqEAsv72qxPNaMSvtk0AtLKkL5DmCrAIfCbHVQshcgv97IM6gucPpOtpwvI9Nxtl06gGyMXJ2V6LNLBygNBoOKpoCtYaNj9bHzimOiX92mB%2bBztFh%2b8NBO36wd/05JrB3DV2eDB3jbYyt9Ds4WmaCnPbZyUwC/9giYBslQTgQqnAhfvu/169d1BBh6fCGQ0Q2NzeEWyyP/5R8eTc0q%2bmLUk4d3ou61tQzZvPvLQQs3H54BoyGgtqEJwW80fSnmA0WHevRHiK0ntjgIJI7qemaL98PlimytQr7DJD6GoDAf7LrElvnFadFPGgm6OTo64jrqAtFgRFVVleuDBw%2bcIB5wBmMUR0ROWOaQqyteWrF3DM75v/3pnvePD25rX1y62/%2bfM/eMR2efnbiAy1kULZ1O1N6Z6tEgalry1ER0Agmhcf6reVvQ9cL/aM%2bV0ZxPNbXTkvA%2bpLbML/oM744Kh82YMUMlRx/zK86Icy4lo2wc9JXQfvuW%2b6P73wGJec1x8sKy0TwBYdjRLfp26LzY/H2arS094Yh3D3wYuiiTkpKsq0BhYaEIghC4WIEGh/S5i3UiCE59rzwFy5Yb1zECQwKl%2bM17uybOyz3ozAAMVwEpCBKCKwmobFJh0jPabAU8RoU5nZLaWUGQQM5KhSVUGq%2br5EDwqcEQD2zj0kvGYHnzxnXXq/VNIgef8E7JOEXEEsenrL9/dzAk5xs5gBwI2ssD8KEHAQgOR4qfm5s7HEJVIzBBZE2hjI2ZzddGPmz/Lrjk0Dcx8/MPzfjp0R2/ZrN5AITBwyx/feANX/9fPz9xIeoPd1sxFB1J0yCEADSU2NlI8od11GOo/QwBWCC7H4EZ2uo4HyHUdiRrTxJIQDqImGWn%2b0nahhAI95PGAkFKpRKHRfCGDRuiv/zyS4/bt2/3Rk5O0qup2RyLfH9OTmXEq6v24YqhAMQPMcHKgHXULSg43BdsVGiLPB7jAuL16APr/VlcQLzcmagqorkT8XUXiif6sziEew4X8sHqaO9EK4yO6q42bJlf9Nm3uymgCwkJ6RINAtcXh03C7B3aiQtK47BefanBs66hSZy/zy4ojYapISYa6hub9XLRoI1IzlMuGpSztaWnDJSmBxGlQSHJvAp6vd6aD4CIUJzLEBRZGZupySx%2baUD7iKnv7RqA9Uu1jZp6U7O2gx3uipzybvkgsQNMzQg%2bKrqZKBw4CjJU2J%2bxOGZLdFopTXSSnv1nPjAT5Mv74Jgn35YBbbdUOGzatGldlkEgQQYCuyEg4kvD1/eAl2UjIGxSRulg6gADe7inZWKIxdm9DNrwIbsMytlK8wFYwYZ%2bKpUKXypk9erVUadPn3a9d%2b%2beSIQoxnaEDoiB%2bS1MX7r72fc%2bqBK/WLP5WgDMd3GYARMMAjI0Duug60dz14nmuUhCkEyRP2ciLCoCwlD62mq6LtoiaZGQIDXprf%2bpXTCF4Sry4UwiJULOhEtWIhRHaej%2bsArg0jYcmGBiXV1dX1gFeBobCmifbPnL91pA%2b5f3Hb8QCysCovYzIMNvtdzQVl9uCE/PPfjb2603g4nGGgmcGC0V6S1HVfWUZEX0jkMmx2iy1JajwZ3oLecDV5EhlAPQy9Fmzi8%2bV78uwwIpLv7Wrl0bIrcrwwKL5HnFoxTGxQ40AtzY3BOnx/ySCVjCkqnrSTBkY/j2xIeXDR6ge9o0YjtCitdee00sYQrI5gMg6Ambk3PQPXVhWbLkxkGsAwEEx%2btf/sCxteWGHvDBgWdxfDjMAxgfDkuYYCdbzhfPBLuEw3z%2bgU%2bKsnCYpoltEIQO0KenpztI9cD5Q2COewHYjeFGhQejsbRCJAya9bEGosTgg6drVPZwcIwFWEZXastWBDt8%2bMiF1DZsu%2bixF93VarUblOp169aF7927F3dqlACCmNVxOHb2svLx/e/0b208EDTt/QqxA1IXlQvE44MVvdPELwFR4QiICfSWP7eHfl1Tz6I90QfVI6B0pK/gwKW0g%2bjhHMkegU205X1QGUF83oHzEcBllRxIVGTrwLVXEeEySqlwIoAgguFwYIIj6%2bvrIwEEEUxwOTMA29M/bG9N2FBycuKKj4%2blWP5yXwurgo4AbAQMd53F8jBo%2bYfHpqz75MQYGC3xQJwiCKQMlPVFf8k0tJk%2blGL5YURTjXTPMKkt5QawTGZ%2bSYftMJ8wlMsws2vJ7P4k2K4vSIx0ZKgYEUIm6O3trewKkj/6pi4qG4ZMkMMATFtbh%2b/Y9OJQuB4LsYH/29kHlPYwM1tMsCf7AsgCbSRW7doX6LQKIBOEgEhkgrW1tQRW4%2bD6o8DnF1eMhHkexIMgBiPsP3AEj4nzS0fjcglLJYsMOzFBDoysIMgzQT4nyCVQFTI5Qd5HJybIsT%2bjzFa5PBNMSUmRzQrDUifq79%2b5FQYdMA7muLukA6wd8krWp24AkuP%2b9qd7wYfO1DhdrmvslKVl9FZCY/kOkF0FuKQq2%2b6yor00HyDdipNujRGmdLsKyOYDampNeqC6EyRDCSO7TsM3cfaOxLMX6sJ7EMu7yw3fnuQDaBr9nzdHcagOIxAcnJWVFW8ymdj2ONLUIOAAfsD0xqRlV/7Lfz%2b%2b62tqatZSr0dTHO4LoXEw4ITmzY0Hnj/y1eWU//rhdgCMnkCK84OoTKAtbabzBYkhRunL7keonkD0lvlgbRJYnbbusV0siS93L7Y9HsS1D6TwO1qaDwh0cHDAddRn/fr1A6qrq31aW1uRoXnAi%2bGhBnXpoW%2bmvrlh/3isX6lv9KK4G%2bllJMb3F6%2baNHjt1VX7xlccrZ5ksTx2h5WCP5zQh1YNTzrE4Ek%2bDLQ8urBrnK2XzAGJQdyhB08aheE0ZVzZaGC2kkMTfeiARUR3UyBUjgqv2XkiNWVhWX/JUHKTRnJAhEKzir6Y1gMa6/ELUWGvHuwtdD0fEBMTo5SeDzCZGoUdB74Wl8fVO46/8srKT8VlZc%2bx36u4RIQIgke%2buiTqxqeX%2bGd%2bdOx3WJ%2bTU6k0/28y07o1xidFicV1SopytipJQlQgfafzATgd%2bfMB/DYaB8KMEndPhW3tDL2%2bfv9LCuENlRQE5dZwCJf/vSebo7/ECREbO0N2gSDSyQgCwdi8vLyBFy5c0N68edMH4nq/H9pbfSqOVIe%2bnV054w93W30A2Pwo%2bEDyEUH7%2bLgc%2bgMj9Ae%2b4JGee%2bi3u49W6x7ca/U2d9jiF0KAQsbnT2DlR3FAFDIzGsbMtw%2bxQ39a41l7LIcxHdmij360kcL78CVbPzZC6L4IjlFyh6QGYgfk5ORgBwS2tLRo6k1NPhbLE/f3C48MzC499Tqe7qq5avKlGMCTgCeGwMXnan2TL57wWrPjxPSlW48mQN0VQJTZ43QZSnVvKj2Ir0ezkyL08hqitr4s28O1iSPyxPvATozkfLDrmGfwkfjAjojs0RRImL1z%2bLZ9ZxNkhpiblAfgb/v%2bc/EpGWWj7NmsBF2fHvIAnb3nA2xtjsoekoqMjLSCYH5%2bPjuuqpi17nNnYHcpd767GQbMTrWrqpqP5XHIBbI4vLXlhqj/4/dtIcAap05eVCaex4MRpBr%2b5nZFc7M5vPJUjXJ98UkBqLKSss0%2bjc1mEQQPnLyoLDn0jdCRbDGHf3HuimrZtqNC4adfCbgtV3b4vIB6CMiEjz47K3x%2b4iLz4YeCddRt2/eVkF12SsD7fXb8gtB26wYmaRTdbY/zSVE9BESO7D%2bEvclj5xUbLD99H1R2uFoMP9vb23kGJj58W1ub4u69Dj2Ew0Ezl%2b8Jn5RRNr5TTqG9tctXtTy53wfIVZcR8FDGlvRdvqrlx3ueKDI5jA4fg/dZdYBtgjQYEneHnZyckEq6w8sb0hYsFvf4UheW93tuUXliRwbY1PfM6VPiKnD06FGB9g698NAj1s%2bdOyccOXJE6LBtFDceJi0oG5q6sGwi%2bNBPnF8cUHro67gXllR4T84o1fzT%2b7u8DS9/4J5bfrJv4d4z0drpBe7PL97lPfXdck3yvGLPMrCdvqTcJyWj1Ou5RWUaiEQ1UxaWeJcePBs3aX6xZgrYoX3ozM3umytORRXsOhkZOrPDB9pPzijxKjl4btjk9I8wz6F4d92H4stmZGQ4yOUD4vFsAC7jQIQSi4uL9Zs2bdQtW7kuKmfdSh1miXbu3JmQnZ1txA5au3atccWKFWFbt26NLSoqGgJ1HYwcI8rKlSv124uKErNz/jN889rFQWmZBaP%2bbenW6bMzC8euyv9k2pzM/KQ5mQWJc1cUJL21NDd%2bWfb2CZnZ2ydhHXVwLentZXmJqwuKp85fvTUhbXmeaJ%2b2PD/pnazChPWF5VPm/ccHCXPgf4ePvBGZOTsmosxelj9ibib6wGubE1flF09bnl00YM2qlQZ4ByOwXH1lZWVIWVlZFxBUwg%2bHt1BVVaWkQ8y98ILrMzNFA7VabWA6a885Ovo4Oztrpc569eoVwh2J54eaXHyOc9dfxrYvHarudEvQD5RhquIRPxkfRkr78x97qEaj8Xza0XlMk4svMDrlBYXa2Rk7BTc9elNnsAfABxfnpKurq6J3795Mj%2busGDY/M/F3QjOwSg//MHgZQQxCxr%2b%2bUYid8GqHrdIhUCGIexIK1EWPnkmJFGGgo3NvMcKLGvmiqFO7euL949VuYqmISJjWYSuowhSCUjyiM/Q3aUKu2aIIH54K14QoQamyRrcqlQo/chJI1w6AESDbG/CVf9Gj6fAQ1pNpVLqDePK6/w8/4Vfwy4%2bWgT24r/B3voeo%2bx%2bVVSGibeLdSwAAAABJRU5ErkJggg==' /%3e%3c/svg%3e\" width=\"453\" alt=\"png\" data-srcset=\"/assets/static/output_12_0.e18b67c.39bd037.png 453w\" data-sizes=\"(max-width: 453px) 100vw, 453px\" data-src=\"/assets/static/output_12_0.e18b67c.39bd037.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_12_0.e18b67c.39bd037.png\" width=\"453\" alt=\"png\"></noscript></p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># With z score we can now use a normal distribution for our calculations</span>\n\n<span style=\"color: #4C566A\"># plot</span>\n<span style=\"color: #D8DEE9FF\">x_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n\n<span style=\"color: #D8DEE9FF\">y_axis </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">cdf</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">x_axis</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">parameter</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> x_axis</span>\n<span style=\"color: #D8DEE9FF\">df</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">1 - cdf</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> y_axis</span>\n<span style=\"color: #D8DEE9FF\">line </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">parameter:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">1 - cdf:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">properties</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">Probability of being above limit</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">vertical_y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">2</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #B48EAD\">0.001</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n\n<span style=\"color: #D8DEE9FF\">threshold </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">([</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">prev_threshold</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">: limit</span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #88C0D0\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #ECEFF4\">{</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">z_threshold</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">: z</span><span style=\"color: #ECEFF4\">}</span>\n<span style=\"color: #ECEFF4\">])</span>\n\n<span style=\"color: #D8DEE9FF\">rule </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">threshold</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_rule</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">color</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">firebrick</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">prev_threshold:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">opacity</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #88C0D0\">alt.OpacityValue</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">0.6</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">rule2 </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">threshold</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_rule</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">color</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">firebrick</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    alt.X</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">z_threshold:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">),</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">size</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #88C0D0\">alt.SizeValue</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">2</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">line </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">rule </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> rule2</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 447 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-9)' width='447' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA0CAYAAAA62j4JAAAACXBIWXMAAAsSAAALEgHS3X78AAAWGUlEQVRo3sVbCVgU17KehWGGfV9mBhiGVUAWFxQURQW9GsUl4haX55armLgggYgKUfZFxCUaxSXRSKI%2b4zVqfO4oAqKIorLOoEaNGGPUuOQlMc87r6qtnjQzjTH3eb8331ffOV1zprr6nFNVf9XpEQje/McEyJGHLwIyBbI04OO1hDPmzz4SkiOg1uSNaS4UCplm2LBhgjttdwWP7t0WbNlXKRi1ZLcwY8sx4fVr1wStra0MXYM%2bl0JCQhjlRSJRADQFIGs6SFsueEnpQKuBsoC/FGgZjOsM14uhPwloDlAOXGdAOxvaZGj7QrsO2kXQzod2LshLhTYCrj%2bBdia2ICcM7xscHCzi0%2btVhOP/HR9cISmQE5A/kB9QIBBOjCftjj5AzkC%2bQBZAShqjAnIHGgfkARQE5EPj8DsvIBldu1Ire2OKw6wqUMnY2FiXRz89tnpw96bV5n9UOsAO8Mn69LhKp9OZtd3%2b1qaxWWMDu8EaZtAaZhLJ9vr169aNjY02uhcvLGGche733y2glQKZcMgUZQBJgMypZcdJ6Hvsi4Bk9Bv2OymRBV2zcizxvnh/0MOGyNqAbHl4OM60ne2ampriBPgtWLCgR3n5mcBnP/0o33P0vDo%2bbXfE/FUHJ%2bVuO7EQHtr/u1s35BptqzsIcINrbKOgdYPWvfnyZVWbTmdfnpQ0saqwcFSLTudw6dw5z0uXLqnq6uoUTU1NIQ0NDd1BafllGAvXHtAq4brP1atXvYHca2trVfX19corV650An6vyxqNa%2b033/hUFBaGXnv40PVKXV2n5ubmXhcvXlS0tLR44H3h/q7Q9gDqBH0F8lA/IBXqB6QkHqu3J1AA71ZYtWqVy5QpU8wN%2bUlrD/WesPyrkYZ8FGbIOx4XF3N61qyePGNx5zjy8D0MbRKuJa1aLZqHYCq4l88FAmvsN509K8EH4pEhB5Lx8FV8zwkyvHknYMWKFcr8/Hxb7K/Zulu4cM0hMfZhu1nPLT4YFz3/c7RrQcKK/SJta6sQBPmSQMHZtDTGGZ4cO/ZvFQsW9Mb%2b%2bYICEXwnpDEOQHLqC0E5ISnpDdcS6rNjLWACmMk9OnSobH9gIDNxmitXLOA7T0MZ0MfdYM3yqRUD%2bbA8jhPU8/VBQCqVOmBYSkpK8tq4cSMzAdXV1ehdmYeCra/85vRF10EffDEErw%2bfuSS6cf0aPpwfeVXhhfXrmbB0cvz4wRULF0Zh/%2bJnn5mwMnD1cYuSQiIO3wdISsqxPEsgNSNv4kSzg127OtEE6Pn4e854FZANK5smx4RdIByLOhKZGE6ARCwWo3fuM2fOnH7nzp0Lu3Pnjlqr1aJivmhLzS3avv98di8ATCF%2b41cV0bpn99yB5wffx%2bAK4kNoGxr8ftDp5FWLF0%2brWbNm3D3oaxsbcYwv2V13oF6oLCpGfDXQAKBOuC1RMSAvuA4G6nejrc2j8fTpwAsbNoTffPhQ1arRBMP3/XAX0O99SV5faMNQHsognVj9vGiSWT76is7ttn7Pnj2ZmVy5cqUiLS3N2tA0wPsr0ROHzNgiH5LyZS/kKceuF3JtqYDaE6NHDzwzd24k9je0tzs7IBcee0SlxQY8MzABDIeCvc7OEiB77LdcumSGC8IjA52epQEP9fPiGcuYXTsmPBzT5ubmusMk2GG/srKSu03db9%2b8AaYRIRyxeNcw5FXV1otpBRgTqFm9mnmIk%2bPG/a0iMZExgdpNm8SsDLixI5CCsyVZPq66KSvH0AROjBsnOxgWxvoAS5wwQxMgj2/D%2bhGSZcLxUawJMD4Ad0O7Cejfv7%2bIJkA%2ba9Ysc55Zc6m90mSF/ZiFpVH%2bU0qYSWrRaNVGUWD48Jjy2bN78sjAGOzIw0flDXmmbBQAOCgqFQiYh2uurjbF1eaRIcddw8P3fJ0oIAFYifBzwOzZs/uCDwgGH%2bAOPkBNNoqxMwLMIEyn%2b9UxfdPRYTmfnYjRvXig0Gi0/cm%2b1dr6eq8fdTqnyg8/nFKzalX8feiDX/DiyOgC1IO2Kysb43g0a8vEw7AYCBR14%2b5dZUNZmX/Nxx93ufnTT27gA5Dfh7AHVz/0LZ0JF6hJJ7T3fiRPTX4D74E7LqhdFJDJZGhjNunp6T47d%2b50RaQFQMUcBiKhJ/eB1ZYDXwiO0GNixleDsQ%2bTEgLfy%2bB7s6aKCoS2glPTpsVVLVkygFbMAr5DGRJolaSICfGQcEWDCFkycoCQ54DO6olOJ4boYnty8mS3/wF0CE7VgRwmVwZudXR4ziQPZcjIjHBSpDQW/YcMfQWO58UBBQUFCpgEax5AodBqX4aZmIU7ZIOTvxhIJqC3pWU8TnBVexn/khP8ytFRstfJSe8E%2bcANIbzXdoIdAiGYAHlCQoIFzwS4cG8Qk7ijX%2bDUTRaPfrhtZI/HR4yIKU9I4EOCNkBOfGiNdX4cHvoARnamQCD%2bgvUB586hs3TrAAmavQ5S5fMBJoADMLVUJScnhxw9etTr0aNHthqNBoGLEyUPGH%2b9a%2boa7TEpmb1i//CCz08GPfj%2bdlhTixbHOWrq6pwxkYHVH3MuJ%2bct7IPXxm2JMmwpLgeRPCciO8QH6MSgxe3tSDy02643Hz%2b2vvL118qq9HS/OzqdTWtzM8M3kIETG0rmZUfRBlEnLlo4kD3xUE%2bGj3kDdwLEJiYmmL7a5%2bTkBB06dMgfJsARJsAVZ5bsER2YX31Ti5NO99Ru8YYjkYvWHx7066O2sCsNLZiMuMLDKn6FDA1g8Phz%2bflx/w19zdWrmJy40sMFAIWQEq5EqFhPcmTOxHMiRxb%2b7YMH9vWHDnlU5%2bQE3H7%2b3KG1pYXhk05yIpTXjcIpPiTeDx9Sgc4bF5F4rrSTlR0mQ3l5efKZM2ead2ACetMIm7nFCXxBb53uF6fXDYOvSoYMwyA3GZoHYXAHJUPgVCWvMIE3kgwpMjMzbTgC2FbJYm38RM3dbh63aGcM5Ah6J3MoPJyx4xPx8YPOzJ/fiyZDyJFhj6vAyuXwMVSaGChuDhPAKA8gyHSfh4cDA4Tq6szZhzKQgeHPykCGyAjx/QGU2gEhkUQiwdl2SUlJ8SktLXXEwgTk7uhwpISe0L6cIQMUna1twOKEcEz6fw4/d6kBsMHPYuCbNhw7xqxA2eTJQwELRDMQuqxMxji0lzd1JdsWUmiSEprrxGR/MAk0Vkw%2bg0Fx1dnZVsfi4jAECwBX2BJmEFICxernTWYhIhkSCqkBJM%2bUwivyZSxC5CZDuGIR8%2bbNi6qqqgpta2tTARBCod60RRFohCFqa2rR%2bLx4%2br3bBx8fmnTq3JWR4Ag9IER6g3I%2bAH5cqlJTpwIsHgOJkQvEbR9SDmV0Q5vEPqXA3pTIIJjyJyfmTSCmM1BfAELujadOBQAW6Hbz0SMPAEIMn5VBcrAfRf5FRTK8KOHqTwAIx3nRQjLOmNcEioqKXOfOnWvJYzOuhnF20AelIUWlZUOMfMDIkbHlc%2bZE8MhgPHcHUFhowJOyYXA1OOmdAgGTojfX1OCqu/PIQGdr/rpQmDUNBB%2bJVIzUJ0PFxcUMzj979iw338ZyEsP/bH8VA1ri03YHQSicwBRPdp0WX1i3jk2G/qgHbN0q5iQs7eoBHNk%2bhOD46wHvvGN2sEsXo3qAgQx9PYDMSkAm5cvhCTl1Ar0PSAHqyuKB7OxsBfiBjnZAOycT9f52x6Ubj0ww2gGjRsWWv/ce3w7AAqUzH1hhM0ODHcAszBbQa7dYzOyAlgsX0ObdeWQoO9gB6j%2bLAmgLSvABWMKKgO3fB1YeCyKeWBCh4gLaWG/odyFlfb69cd3r0tUmf8gLZt67c9NTA2PBB/iC3bsyPmDNmrHYBx/gSyuMK4Q%2bIJLs1IcI5fUnfO9F9qsmHxB9o63tpQ/45JPuHB8QTWbD1a8P9EM5SZAXAa8BJM%2bHw/fnJkOIsU1tbGwQRkoyMjI8S0pKHNDjXr16VcKp1amopIWzJ4EJMNFoW01m5u2L37qvUvrbT3fFl77ez5SayyZOfKsyORmzS0H94cOsR2axhLs%2bzr8kITlA9Nhi2rZCgs3MNq1MTbU4EhvL5BCQcdqw2xd/z%2bpHzs2OLXmR55eSbBHdy4TuIWVNA20WbdWaA4TcwA8wtgSwWF9gpC3GbEN4cIFr/DqGn7n1%2bDQARIxym2ckMj7gxJgxiAOYoijAYhEnVjPojZOQ6B0SKsjyOTiAcWD/1bu39Gtv75c44PJlc76iKPkoKy52oSKID5fHwQc%2bvFGgsLDQderUqXxI0JmLBNnP8i3HxnX7%2b1YPQyT4JsviMw3K4rgYbxoJIg5AhcOSkpK6lZWV%2bd%2b/f98ZcgEFHTRgwtGVAAtOhKKhSaPQ6Z44bDtwdjLggVjID%2byvXqxzf6bTWVckJk44X1g4/Cn0NfX1iCAVlFQFUeHSiXgKwv%2bRFMtdiedCu6LHt/fvO4AZeUJuEXT7l18cIRdAfk8DGU5UcPWjhVLQhLgRfnHh8OS0WwIMkSDOlFN6enrgwYMH1U%2bfPrWGCbCnbWtFTklNq2jfotHa636%2bZ3ukom7AjLx9o/C4q/ZsDWaDphAB4quzsoZgH7asI8mwJkcUQPIciGzIOaKSdgSXbSi/D7v17Jnllb175eAHfNp0Oittc7MbTaIVJUGsfiFsKASePfkDJ5JtS3Lt6R7I79RhPQAiAV89wAgIMfZedTloQOKOAQb1gNjyhISIN1UPWAm%2b6ku2HlBT01E9QPFX6gF8OQLzARAkT01NterAxowqRU/uf%2bcxMKm0X%2bR72/STc%2bLttweeef/9SB4ZOPu8FSH0zgY8GVsR2gUmusfG5mUR9uJFxPEefDjA0EdR5PHiGWvkA7AegAz5/PnzAw8cOICJh7S5uRkTFEtCab50EwwheDxlUXmh3lr3/EcfrA8uWn/YU/fiOuOETs%2bYMeJsWloMs2Lnz1sRqpNSwdKbkhJL4svoEMSW6nsWxMNtGghYQnJxyxb7UzNnejwBk9I2NTlRwdSUdLOkvj8dkuIEWZAsa5KNIdaCiOX7GVaEukHbGSYgsqKiovPdu3fdAAh5YsghnN2TqkJubHW1sVmjfnz/u4iPNh2NgXA4WPfktuIWVoVTUibXFBeP/lGncwRwpCYZGEYxmQoneZ4EWtwoufGhhElFp7h4etP7xvffyxtOnvQDYBV28/FjBTjBAPgOQZmSfu9JhQ90pEGcU2EPOmGKJqfnyeF7G1aFuSbgMm3aNN5zAb4wqPvlB3nA1E1O/Rfs6PV/OBfw4DkX0IfB9zhhsLmD02E6F3jtMNihDwAn6LZixQrG3srLy4Wc0xtcKTsOABGACYjufvet97BFX5oPT90Zq/uEToc5J0MAYcUcsMJ7OMqeDBmc7FqwSc/x%2bHjZgZAQ/ekw3%2bEo93SY6g0CKpf7coog7ImR8emwubk5/thk0aJFKkiJrTuoCNly0dr169cETc0a5gZDP/xyyNT56805SJDZEWWTJgk56E5fETJAgpgDmPAgQWb1vgkPl%2b7z9ORWhDx5ZOiRIIcnYp0dd4fxIUE8GeoHbY%2bFCxf2rqys7NLW1oanw3gy7Mt506IrFS18Kab7Ah4YqPvtvltayZHR678sGwDO06Fi8eLpNWvXtjsdJptnTofZk12SjfIGIDB51elw7caN%2btNh5HNPh8m%2b%2b1LBRk18b3KMMSTPl3NqbHw6rFQqEYubZGVluQMcZmLunj17uFvSjbMD2K0kbGrRMN40LnWn76gPS5nYf2zc%2bCFn6AWJ6oyMP31BgjJAiQGO178gcWTQIOl%2bf382F9C/IMFuax4TYFdazEmcuHyRoQnoP/n5%2begDmAcFSCzk2JgbWxDhvG2Bb4kwJjA5c6/5qEVfvMXY7Ljxg8EHMBNwYe3adj7A4HRYyC2IcN8QYUKW9uXB6/GRI2UHOnfmviHC94JEuzdEOLbuy9G549Nh9pOTkyOfPn06XxTgTYa4Z/UDF2xnEGH50MHRp/5iWfzflQzxvUvAFwXQB6DXVoMJhB47diwYkiEF%2bAAVFTLkdKobTPFXRTOObd/6Jo0KkiHnjJLDgxeU1vS9mpIYX72yOP4B%2bAPAAZ5UAFFQwYI9BVIRIT7oQ2bgTpPhRnbaC3CAa8OJE741q1eH3nryRA44oBPhAAVHBoZALLYGcvRzJ//Sl%2bSxOruTTwhslwxJpVKEqKZgAt67du1yw2OtlpYWK0o0EMX5kyAZ8RCFYRuq1bZaPPz%2btsWevSfsh%2bUfHVo5c0ZcZfpHA7Go0nLhgjWNl1HGx74PxMrGE9sQgskWxDenHRd0F9DfpW3bHE4nJKgeAjoFJOhMWSWrB6tfAHs%2byOpHiVEoE1H%2b4FkQ378jE1CmpKQY5QKQGcoBGhvlArBL2mFtZcphvxXTP0z9Yc47LNLSJzmX6xvt6hubXYxfv2lR7/7mdLtcoPrCZbPGxmaPl8mQSLLDypY5Ha4sqzBrbGox2tYNTc1utXX17ZK1%2bMTVQpDt9ZeA0Jo1a1yys7ONsr6HDx%2b6Pn/%2b3Ih/7949o2wr9z9SlmxIWDrKCDUyb3r%2b096I//ypG89Yse73Z0zEwJd3WulFa4b/4me58fhfmVT8dWTj59atW%2b2TIfgEQ%2budkJDQDeCwatmyZVZ5eXl2EBHs3333XQtIkIIhLKoTExOtAC3awU6xhXBpf/To0fDMzExbMB27wowsh5AbDZL974wfsiypIH1I2q5RE5d8Gjcl7dOosSkbwxav2hm7bN2eIWOSN4ROS9/aHWn8opKw/E37Rs3O3BYxecnmrlPTtnR/J3VTlwX5pVE5G/eOeHvR5pCElDWRyX9PGzA2fVvogrzPo3JK9o7gyoiHfvaGvXEfrPgiegLIQxlTlm7u9u7yz8JzS/4xZlrqx15ri3JscnLz7GBxbeH5HKurq9v5ADG9wd1p3rx5Qdu3b0c06ILmAJOA5LJ27Vp/aH1yc3NdkQctvlCphEkIgWsFXiM/KztHDr/13bwmR528vFidnLnaf3FWsffizCJVTtHHARl5xcHQ91iavdJraVaRF7SqjLyV3T7KXeW9JLNIDdfqJVlFnmnZK/yzC1aHLcku9sBxadlFDD89u8gvM7%2b4y5KslR5L8PdA2F%2beWxS2PK/YH2R7ogxGTmahd1bB6m75xeuUuTnZStJbAc%2biBB3dX/XydCC9xc39eHMPUNiJAwrl%2bb01ldsNP2oeucxbevSWueF/DPrwjEW/0J%2bHH0ZvlBt%2behjcEwHXcKqGc%2b4menku8dtvvwkgL7C1tLRksMDw4cMZJ4ZRwszMjAFCY8eOFaKHDwoKEstkMqfo6Oh2hxpDBw0SWVtbG/kLN3cPU77ZtrW1M8IXJ86cF8D9%2bP58gfrZG77iZ2Zm7iiVyphDl7ETJgt37N4nGD5ytMjcwsLeysqKkV9SUiKIjIzE8p8CZJi96o8T/8oH0eMYoNFA%2bB4hnhiNB5oCNIne7w8n3jj6P0EI/iEC5wz1pt%2bg85wDNIR2jDfJxe/fpt9OBhoMNItW%2bP/1w86YEykdQQ/ah/pYGutLf3rAthcp7UMm1ZOO5jAZC6br3pwxfmROnUkeHrt3B%2bpC49wMw%2b3rfv4XKiDQ8fgBSWQAAAAASUVORK5CYII=' /%3e%3c/svg%3e\" width=\"447\" alt=\"png\" data-srcset=\"/assets/static/output_13_0.9e473a1.5c5ffb6.png 447w\" data-sizes=\"(max-width: 447px) 100vw, 447px\" data-src=\"/assets/static/output_13_0.9e473a1.5c5ffb6.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_13_0.9e473a1.5c5ffb6.png\" width=\"447\" alt=\"png\"></noscript></p>\n<p>With the calculated z-score, we now have a way of also using the normal distribution without the need to explicitly tell $\\mu, std$ for the distribution.</p>\n<h2 id=\"back-to-the-real-world\"><a href=\"#back-to-the-real-world\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Back to the real world!!</h2>\n<p>Instead of writing the survival function which we will explicitly calculate the probability like so:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># score of the survival function</span>\n<span style=\"color: #D8DEE9FF\">p </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">sf</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">limit</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> mu</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> std</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">p</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">0.02783823512029548</code>\n<p>We can now instead use the z-score for each call to a distribution.</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># score of the survival function</span>\n<span style=\"color: #D8DEE9FF\">p </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> stats.norm.</span><span style=\"color: #88C0D0\">sf</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">z</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">p</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">0.02783823512029548</code>\n<p>And we can see that it gives the same probability, just using different scales for the $\\mu$, $std$</p>\n"}},{"node":{"title":"An Introduction to Gradient Descent w. Linear Regression","path":"/an-introduction-to-gradient-descent-w-linear-regression","date":"9. June 2019","timeToRead":7,"description":"Gradient descent is one of 'greatest hits' algorithms. This posts gives a detailed explained and walkthrough of why and how it is implemented and applied to an example for linear regression","cover_image":{"type":"image","mimeType":"image/gif","src":"/assets/static/gradient-descent-cover.1379a33.4b7a0b3.gif","size":{"width":512,"height":384},"sizes":"(max-width: 512px) 100vw, 512px","srcset":["/assets/static/gradient-descent-cover.a67b0b2.4b7a0b3.gif 480w","/assets/static/gradient-descent-cover.1379a33.4b7a0b3.gif 512w"],"dataUri":"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 512 384' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-14'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='10'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-14)' width='512' height='384' xlink:href='data:image/gif%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAwCAIAAAAuKetIAAAACXBIWXMAAAPoAAAD6AG1e1JrAAAPS0lEQVRo3u2a%2b3MUV3bH9Wfkx/yQqvwN8W4ckt2sd7MuL35usL32mrAOxl47NrYpG5ussRE2gTUYjFmc2JinAfFGCBBIjIQeo%2bdII817NHrNaKZnpnt6puf9UD7dByYqvCChfVRtVW6puu70dN/7/Z7zPeeee0cNtb/w1vD/BGrzC9pfGAFBnMvlCoVCqVQql8t38PkzEGv4A9Enk8nZ2dlEIpG2mqqqmqYZhpG1Wp1YtVr9ExFrWDb6SqUSjUYVRQE0iPkIVjjoup7P53FLPB7nKz5yE4apVCpjNR4uFoslq92N2NK5NSwPPaaNWQ1Yc3NzWD1vNcABsWI1%2bjyG%2benzGB9hxTOQ4XmI8aT0hRWNb4UYrywxuhqWgR5tAJq5MXCEXjSqJpO6ZWrQYHixNB1sL8QgwFXI8BUekD4PMJoQ45m6FKWfud145o9DAPTgRPRcmSAcDoOSMDByeSxWLpXyhQJfYXgBRBNL8xh9kNFHddwU0BCmI2RAyR3xHiMIZ74VR93NCQ33lSvBge4lUiV2NZygxGOjQ%2blQIFeuICAmFuWIJAQQIPK3G%2b9KqAgZ%2bSgkJX5o4gdexCiFYpGh/iACvAwgJohEIoyL9BFO0mqR2ZmYkZ09/LuZjWvThqGl9LiigEYCF6p0sKKkJojdISEhWScmL3JlZPNdSOZzasLsL58AbxJVgBZrCQ3RKBJKgjKdCX/eGHz8Ae3016X5eSAArmBpCSigB9Mdlpa%2bEJNsewcx80Uy2/x85ErHxNFz2VqlVq0uhwDoMRJAQYwZMLwkR6630GtaZGYqtWfj5JpHEu//MmNvVQkIljZLBnV9CzgMAVbxhhBbGBv/RyyfVxOJfK2q%2byev/82KaFd/EfMvgwDoJUviUMYFMX1mikWjOAHoCbxhBkCf8dn65EdrU9te0Xe%2bro33p3OFjBXl8qIFNGGBzkt01tNr3epc66mWd%2bOanorNdD/w0xt/uyKRjLMwLkdCknBELd%2bVEB/Ds7OakdOHbcauNzL73zMONmZ2v1U4t6c45SnjOisDir4l7km0Cy0tcSJhULidvqCCcjKR6eD6F21/9dfTv92WLhZw6ZIIVK0mHafTKYixIrYHAR1ZernJ1XSCGWuaYWvKH/s4e/jj/KX92aad%2bdM7s1e/zivT6YwBxO/qW3L/QmJ1CaU0Fe9lp/2xD3/tfeIHzh9/L3H1QqZSRXmLEJAlHXuPj493dHSAz%2bPxMCIdbC%2bFAIhFstAwV19VjaGfmcls%2b9H82d1G2zEIZG6eyV47nGs7YtgvxPxO0GVuSSguSUayDQSET50YjXUwWyjm/I7UrvXRt5%2bdeW3V5EtPpqcnlKSay2aXRAB7AG56eppBg8HgzMwMQMXROEGx8iM0WHqhYUZCTEmFXNmes7lrh/T%2by5muM7q9WRtq0wZaDfv5uLNLnfazzJZKxZSWkgpPMpIErvTNUopEVCqntWRuuC1/8MP0Z2/pu9bHNjyT%2bOz9SrWCtIqLemDhaiUdh8MBE2bCYGbCsRIz88GQO1GraVpK8Toy9guATox0JBy2yPiA6rBN%2bd1Rpz0x1jPrHgqGQvEk%2bPVSsVCtUJbekhPN1H0qlc3lyf7JkMfoOZ8/tzvX9Gnu%2bPbM/k3qh2syN84WavOamuThJXlgamoKk3d1dWEbPCAFj0hoIQ2r/IlayVQJuwaTo51h99CUbzzsGg5OBENeDwQ8/mmfO0gnGAyMeWfHAtFQRI8oqaSmKwrFksH6Sk4iUSlzkWRgVO9vydqOG7bj2WsHc2d35459Yux7NxNykVMRcWGJMZC0ajKuMCYeJicn6xIyA0BRzGQaidSL0Mmp6ZDPPeca8vimQn6v0xfxByccPmXUO%2bfyzw77En1ulZvjgfCoP9rnidtdiX5PcsiXGPbGXBMJTzAS8E9MeUbjzu74SGfc0Znuu2R0nsxdP5Q7uSPf/KVZllareIwIuY80SqLgaZfLhRPgg6UhI%2bkI0KJaAmB6NuIORAKBIOiHfcqYL9zvUQc8yT6P2uvW20cNsHa7MtdG8tdHst3jKfNbrzboVQd9SYc/PuqH5IzfP%2bH3Bf1efOWJjvfHR27qA1eMzlO5C3uNEZtu5DLWJgkmixOQSpPk09raivqJYMGN7fGAuSaEwwmpfyJhXO%2baVB3eqDsw0%2bMCnHZzPN3uzHaOZ5qHinQuDZfOD5QvD%2bVbRwrNw%2bXTfZUzfeWLg4Wrw/m2UaPdmelwpm%2bO6d0uHYfAxOcNQiXiHlZGu1L2S7kbxwqaki%2bWyD9ksKUSQGpglRdQPDSkWuZmNBrjCy0eMyWkxN2Tmt2tOnzxXpd61VHoHDMuDpYAfcZePj9YPtZVbeqpNNmrhzvmD9qqJ3oqp%2b38VU/21vg7Za%2be6a9eGiq3jeY7xw2cY3cxlIInJ3xwcKj2lsxYV65YkuqD9LXUHZlEgkgoFAq53W4SH5q5tQFgIQt5I0GPOxTvcycHvKrdrV0YKDUPlS8OlI7eNJF91TZ/yFb7ur325bX5fZdrB9pr%2b1vn97bU%2bNt/tXqgvXrIVj3SWTneVTnZXTndWz7XX74yXLzhNHpc2rAv7vVPzXhGE4PXk%2bEpaluKboINI1bvUgjd6QHCJRAIkEAJABB7vV6iFvQ4gYFEUUrQFfB4RgMxtN48WGzqrQLiq7bagRvzX7bWPr9U23u5tuNMdU9zbfuZ2scnKzvOVHadr%2b26UNtxdp6/356rfXax9sUVk%2bEh2/xxk0YF1V1zFu1jCac3MuMeSc/4MtmcbGswP1MvyQNSNouEpAyGiehHwjdpJVHqn5npcL870TxYOtFTRdzYdXdz7XdX57c1VQG95dty44nKfx4s/eaQ%2bbfpm%2bI7/13YdKD4waHilmOVrScq/3Wq8uk5WFX3tJj%2bOdJRPdE73zqgJ5qPJDvPxyfcVsWVkC0bEsCUi%2byJZb8CPPGUHO8Q%2bwMDAwxB0ryd9eO3lgItNeCKXXEUz/aXv7lR3XHWNOq2psqmb0ofHC5v2J8H8Ztf5Nbvzb62K73%2b88ybe7Nv7s2t/zz79r78O18W3vu6%2bJvD5S3fVradgnl139X5ox2lueYTpYt7DHcv6xugmQ4jAh0yWHARD0jRT/XGm0NDQ9RCNpuN98lIohxZ80EvZRz1UTSmdLuzB221XRdrn5430W/Yn3v3fwqv78m8ukv/9af6i1vVFxsT//5x8leNiTWNCa5rt6kvb9de3Zl%2bY0/mrX1ZHt58uNR4ovZFc9nXO6D1XYr7x9AMgYvtwcOaXd8YLX4qge3RD536ARtvjoyMAFZWX7G9FEWMCIWZcKxlqPjFlXkkAXpM/vpuY01jcu0n6nPvRZ7fNPf0hpmnN8yu2jD9zLuzz24M/%2bK9yHPvz63eHH9xa3Lddg3PvLWv0PhtebxvLO7qC0yGZyJRWfWtpBeVAyUR85KOVXgIGlAHrpTpSIgrYzGuuXhZTbQ0MTGRTMRTeuacvfT%2bwQrCANDqD2IvbFaeeWf2qTcmH38t%2bOgr/pUv%2bx5d51%2b5zsff468Gn1o/uertaWis%2bUhZ/ZH64QHdPjJrLiYhTYmxzOtIAMRStMuWmhkRBUoWeIsHMU%2bTfAYHB4Hu9/utZcvcyDMotmd0olm0ZBpIZ5%2bZbOk33v2q9G9bkqs3x0AP6JXrvD95wfkvq50P/cLx0POOh54b/snq0Z%2buGX9krfuxVwNP/Edo1YbZxoPalcEMS3UgYoaZpqlyDCM1vHG7SUFwj%2bOthrudoIiExAzmLmxuTjxDSEhBKvORtHKGPhLIbj2SW7VRWflK8NF13h8/7/jnZwf/6Sn7Pz7Zu%2bKJnhVP9vxgVd8Pnx744TODD/1y5Ll3Qp8cy561l9qdpYlwJq7MWWdYZrGNvUCPZkQ/rEX9/f18pCyACVnxu05ouGMVAysLMGUpVoEAg96unM3w5b7kB0bHPLLBh0s%2bm4rMxY9dVl7eOvejF9wP/nzowce6v/%2bzjr9/xPb9h9u/93D7Aw/f%2bIfHuh/51dhLn8S3nyodtRUHvVnKBDVJjKmCWHZ8UsAzPqCHh4exI1OgC/rMvjgBKtDR0VHUDwEMIJsvqT3rWzOZQ4pt2YmTWHFFpWQktHxzp7Zx59S/vub50bNDDz5u/7uf9a74%2beDKl9xrt8xtPpA52pYb9hVSlGlZ3UpoiuRK2WPIIakce2Fv2XmjZKAj7N8bBg2/99BcOngAM8gouMVSqiY7WtkiyrEmNIQkrkjrWkqlr0YUY2BMv9QRb7qWuNJj2McLnkkjODmnmpIjflLmTkBRJGrl8FDOIWUKlMOM2J4tLgFJHEqNc68YqG%2bL4YoH5GXZE0s1IXCZo257ObAQy8khpkkspWfNM2qdbZauxYr5FH/5LPsqJZNOWbvKW%2bd2AtdMyuxxrN02jQd8Pp/YW/boLFBMsXgWEgKMG7IagLgyhHCQ4wNxdMo6kcXXskmQ1d7cJcdidRxmzMQT6YxhHc8RnWrC2i3V5ceAIj%2buDCLiIV0yo91uZzkDOulOgvg%2bjtclBQkZJIT7mEyONevHlxnrBFeUUz8XAYQcuUmT0xdRhRwJy0Ze5CeWlpLhtvxMVyCVmzdvcp/BccLY2BjjyAq7OIF6EIO7paWF7AtQ3MeahU8pKzAGtaosZwJXfh2T00IRlXgJHGJUkRyIwSTRWZcfjwl6Of6Xb7E6NwGD4ZAxyYdv7%2bMXGgiImaUgrZ9QwE0KQ2DBEBpMgIVgBTeoclMWb1wvvzjJrzUCUbWaLFJ0RH40%2bQlDdq2gJ1EymsQeaaevr4/RmEiW4fv4gUNUhBYZ8fr163L8JDWF7HWk3ToX0XUIMB%2bsJPpxGnyi1vkpIpZjQx6WnwAZSrwk58SiMZ5hEAlc7vA62Y8IlJO8Zf5GJieK5DJGkUUEkzA642InknTdRQsjR1hJ2kXB7OnI4qJmIEqRI%2bfSNCk8QQ/cnp4eXuQZXhG5LszpyyGwsPyQoz/wYQ8sDRnxLOEBE%2bYWyUmZJMTq7/IYQFELKHkRiCyUUnFhaVkuGUSyMCOAHtfhontsI5d6Ol0/673b7/KyAGFU6DEr%2biGHSLGEjoECMjmnkR8e5S2p2CEGbTjwFsQwP8SkfJBl649A4B6spC08igQN9pOPBMyU1YRMV1cXwrh8%2bTJw5RcDQbwwnGR9hLC4%2bs/3vxJ1JpJV6mtIvckCIjt0KcsEKBwQD95j99fd3S0VAP17HML9af9b5Y56vS6/hV6SekYSC1eRn6xWdeb3O%2b//AkNKGCFQav/fAAAAAElFTkSuQmCC' /%3e%3c/svg%3e"},"content":"<p>Gradient descent is one of those “greatest hits” algorithms that can offer a new perspective for solving problems. Unfortunately, it’s rarely taught in undergraduate computer science programs. In this post I’ll give an introduction to the gradient descent algorithm, and walk through an example that demonstrates how gradient descent can be used to solve machine learning problems such as linear regression.</p>\n<p>Gradient descent is <em><strong>widely</strong></em> used in Machine Learning and Deep Learning</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> pandas </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> pd</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> numpy </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> np</span>\n<span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> altair </span><span style=\"color: #81A1C1\">as</span><span style=\"color: #D8DEE9FF\"> alt</span>\n<span style=\"color: #D8DEE9FF\">data </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">read_csv</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">demo.txt</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">scatter </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">data</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_circle</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">properties</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">data</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">scatter</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 450 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0)' width='450' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA0CAYAAAA62j4JAAAACXBIWXMAAAsSAAALEgHS3X78AAAQX0lEQVRo3tVbC3hUxfW/dzeP3Q1sdpNsNpD3ZpMACY8EMFAekoIIiWgFW7WKKBUQpUIDJCRCIOEZIIi8hFZAHnmYBASCgKKClFoRBQqBPBaDSdVECvzBaq2133//vzPMrDfr3nzhEfF/v%2b98c3fOPXPOnDlzHjOJJP28HvnOcpcZfzkoKEg%2bduyY9Mknn0h1dXWsJTh//rzr3R0EztM3nvqWLFnCeCYkJGjQ5AJWgP9CwMT4%2bHiN0%2bmU1qxZ06axqK/OcV76xxeN0uvvfCRt2/tX6VJzI%2bvzRKd8/7k8sYCuvLXdKSFoJSIAfcxmc1R1dbURq%2b/vcDj8oSkXQHvUmnjr79Ya0Zr4t0Y3OvptUtLQ2I2NjUastjcHH4KGhgaj4Cu%2b5TxbjMn5MRxW2//vDReM%2b46cCCp/68Pgps8%2bNZ6qqjFxeYyKcZgs/LehpQY0mkg0g7t3755QWlqacvHixU61tbXh%2bDiMA72HAgYCIjCA6A/DO%2bFC0PYFdAV04t8LOsL1B8TgvTOnYbgTJ050rqqqSjp79mzSqVOnGJ1i7M5EQ7Q0hnJM4kG88N63ptYR4nR%2bF1iw9d1fzt7w5hin85vAf135gmgHkMxcPpesAJKhp0dTwCpoc3Nzw9VMBYSRreBISIMKjoTQquDMBCo4LdF6wp2rqTP889LnQVg%2bbeoftg9RurRhGUWDq6pro9VkhRJaziMmJoa1c%2bfO1RcUFLC9WFlZqQFzmQAEMhcoloTijkTmeI1ikib%2bLugEzgbQq%2bCsBFwwF0%2bO0xOtCs706YV6ppynFr3u73ReoQWUJhTs0o6dvzO0ts5BfkVCK7vzRNvS3yxYsIC1ixcv1sFLM82hlRUrIVq7YsKiTwhEJubPGQhNC1w03nVudOKbYAIVnI5olWMpxqY9HSZkTJ9VKj0%2bf4drThcu1LNVrXM4lCvvkqeFAiIjr1sEzN9lATt37iStSRwEoR2DaBX9klAI319CAbKSjjQO0Ctxigm5FOABpxerxVdRqq93TYKcGbOAQx%2bc1qBfgkVIB/58kn5rz1bXxRHu88ZPZQqLynGFVXn0AdgG4W3eOy1xqj6AK0ergjMTqOC0YpLuT12dw3DmXG0nNXmeLtj1iNQ506ctvkxGFKCBEpOSkmK2bNmSfO3atYCamhqrWB0OQSBMoYkCLIp%2b%2bo4cWS/utQPccPS7D1dCkNuYNPluHMzu/DgN0QaQnyC%2bDsd56yu7/hKAcBf1/VfNFHVMcIghACv2e/DXlz8PcP73csDxv50biD4LLCMYtMpxAwGJbomgTPtlRGxsbK/i4uKky5cv/%2bQKoEhAfSQsFziIO9Y%2bfAwrPLvV6fza//H5O59aUXw4dW3ZkV%2bhLxATNju/v2xy/u8V07Lth5Jy1h9IgyJ6kgLcJu9RAXd8C9xIGAwes6bj0IyizCcXvd5l6sq9A6nv7qnbklImv3o9lPXM8%2b3/3BbLxS8a2h7OQ0NDmXOYPXv2HXGCtEqM59vHNS8WH3ZFH%2bxxvYM7LApx9Dyat8OYOm17stP5bz%2bsPAufv5lbHjpqVumYR/Mq9C4f4Tgf6yaLuhNctGjRnQ6DFlc4yyrxSc8qHXF90l97C2ER65lDy1i1Xx4ybVvyyTPVpurauharPCq7lPF78%2bgpcp52JZ9Ww%2bCoUaNEIuRSwNq1a5UWIAawKxIYyW0lWyjADddCARfqP1EqLpgcGL2Pnl3W6b5ZpYkPzi5jk1267d2A5s8awlOefTUC/dMA5vtzSlmyNaFgd3LG6n2DBkzZ0un%2b7NIuyvkcO3lWo1SABwvwnCWeO3fOa/78%2bVGt7HObWilJOTago5rvAFOPIamx4UIgvDezAOxt6z3Ti/r8kNyUZP46t3wGJmkdmVny4PDpRZGwkFGWB9d0LHvzw4D3jp2OMD%2bwygwaFg6HzygaZPvterYNEC1srcyj5Rz1er0X5UMpKSkh69ati8d%2b8zp9%2bjQlIToBNAG0CVRJAXwVOD2P13Zuzl4KGsJ5oe3Cqzof7GkdQpMOk9ZjUjaEq%2biqc7XMlPM3Huw0buHrg7671kzySE8s2Jn%2b2/wdC%2bn9d0t22R/L35H4QM5rvwOMhoxyDU93yXnTmM8VVsZt2v1%2bR9QIlEIncJl1brKSfLEtFODt7W1E83h8fHzfsrKyAc3NzRGoBil/j%2bb7lyASMISHumgFzsYruF%2bg7QGI4Lm/wFEoG4y2C3lfMR6clA1mPBLboXdh0aFxmWv3j3R%2bezHM6fxP8PMv7n2saN8HiQ2f1sdjYgN//%2bLeYbl/ems4PP%2bSR/Iq5qwuO9KteP%2bx%2b6pr6gZCaff9%2bfiZriiJo5zffBmKNhJKjuGyRipl5bxJhmSPprFy5Uqf/Pz81sJH1M1Wg5ioxzCIhMZ08kyNpd%2bzr96dOP4VVzhEWEvA5AzvvP%2b3uLsmb07i4Y7x7zNpc%2bLD8yrydrx93A6Tt0nROdobkfVH4XzChAmsRQgkJ8j2zu7du8mRyKLq44Sx3NwlUSUqKiwKgybhbd1wNuxJV4j671fNUnWtQ%2bbFilU4wV%2b98FoKzDseji5uxMziEZOX7%2bkJR/jroRnb0wifte6A5jdzKwzY66OfW1E5svLwx92ub4Gr8tvvn5I/a7wg80pVK8xcIad6NZidnS3CYbuFwf9ca4ITnCjDk/dLyy5ihQs9DRfqLd9dbQqg9/GLd3nzUNgfCug9Zk7ZPWMX7Jw3fEbxMND1Rf8QhDrmMN/94LThmWV7HqR3bBfGZ9c7HwmZqHRuexgcN24caxEB2kUBWOEYSmTIw9MkqC9v40E2zsenq0P%2buPNovCIP6Iaw5jN46jZ/TLDzlBV7x2qHFXpj4r1HZpV4ie%2bw%2bgEbd/2FpbRHPjzD%2bMACbk4B4ikpKfFBMsTMA0WRMoNqSx7gygTdM0hyeE7nNz7YwwEPzy3XKXm%2b9uaHoVj5jCFTt3V/KLfcjJWe%2bPC8ch1WPblg67sWKM6UNGGTFduj%2b0Nzyn0VvsP45ecNoVTLYGz56EdVkuOHfMWVB4icxC2jdSmgAx0JGgwGmlTH9PR0I1a%2btWMvm1Kjbjg6M1TNA5C5uYTv9fRGA0LgQ4Oe3zocE/T7w6o3RktSmhZ96cOmFyW4fFPB7i7/vtoUCofYE7jU2LF/9P2hbvlOh6qw1y%2be2zLIgyzqNb%2bbg7wX0MPPz48GfiIuLq5/eXn5oKampmiEwVhu8gJo8kMBcYAY0U/OhsIbWjowTaIkg/qx6nbuNOn3kHpUfGer6%2bxXvvx7FAqVaOT9feDIJs3f9PYUVG85c195K3366n2L6SADocwG8x44ZUXls0u3HRoHJVlQ6VGII2fKxgQkYcUH4XsKbUIWO5ctjstqU86BWzD19W55OB/LHKbP%2bPHjOxQWFjLNvffee1q%2blxhwU6KBvcT5Gsdp%2bSpHiIMNSlL4eZzAxRw%2bdppZB8w8HgmNBWYfmDptW5fnV%2b4d63T%2bj2nw81vD4fT6Itab0HbFVuhPCRm2CDvBxWp7I2nSIDcQW5DK5wie9Wmvy%2bM6NyQZ47jMGgVoPRZDotJ6%2beWXfREJ2P6wWq2eTDlG7HlFn2jDkJgwH5CWVRIAGCy%2bQcYGH%2bDUcFxaWmbJ3XB2Q6VeeV7I3no9tXjXPYQbObPYF/hH75lRZODOUweLYZNEkuQui1GcCYqIonR2JKsH%2bSWPTnDy5MnicNQVBZATtOoEPRQ8YVgJ/%2bsla4U3JhggxkcIDH26YHeve2cW34/8fgRw4Shh/Qj3/VfNZmyBXw6YsjXxkXkVBuASkOQwHlXVdTpspWjuSGWlLPxMMMytxL5hJ8ieVatW3RYFiCggHhGe4K0jsl8%2b0BllbOiY3DKt0urQdoRPCFKGQZg/S3A%2bOHFWL4QVh6LtooC0NJZoSRs2bLilLUBXT%2bxHxCzWXGpqFJcYbM8hD7gbCY4r3Y15bEMAfEHm/iMnWTX32PwdLcZGHUBFV7SSj3ILKBRwa1tAnA0%2b%2beSTt%2bQExdGWu9MhYZD6GhDLfXjdn4gQZ5a6z9OiyElFLcAUUFPr0KKw0fz147Map/OfNI6BvLrieEyjSMRcTlDgFJcnN%2bYEUQ5TcjLabrcPrKiouKUwyKsuF46HrCG8PLWhVI18seTwKKStfVETdP7XlS96IkTeRbFZhDNOS/wSeFUXxfkIfDQPuQM5byXuxsNghw4dyPSMI0aMMC5dujTididCvAz2eCBy5lwtndwGqdD5qN1HEi/iqYJrcyLU4kES1C6pMO1jrLIOe957%2bfZDcta6/fKeQx%2b7jsQUV2Oy2xGcTvgADzjXzZDy4POmnODEiRNZm5%2bf327V4OXmRt97ZxTfi0KHxfiKg8fl23U3qJDh5oqhF154od3L4Xp2KDpWztlwQFxtST8bBSADlPikdeJe4HYfiIjr8X80Ncp0Za2YEN0eWd3ofnQ5ys1aiTMptoBGyHlTByLiWb16tU9eXl67HInRYaQKju79AlRwXmp/IMFDZMjNyPqjIzGdTkeC34dq8K72PBRVHlIKHL83FHeHNjd%2bXTitC0dj88KrB%2bcZpsAJ2hs7FPX19aWjqKh%2b/fqFrF%2b/vl2PxQHudOHi7pD3EZ3gZ%2bK0XnwsQevFedmVdBx8uYxtPxa/kxcjlAO0lgeoXcgSL%2bKpglPf554uRlJTU3/SqzG3ayrX5aiHeK5T1ALuBc%2bPiiFPeUCbrsbEX2/%2bf/0boVsOg2JQuh4X9wKkAFIMwfbt268fbtbV2Y8ePcoKCqTMDLdv3z6mEPq7wurqaqaA4uJiRvvGG28IOltVVZWeh1yG27Nnj8zpggnonfoIR9%2bw8wDQEC2901iEo7HpN/EinvROMhCOZKKHZCRZ6Z1kF/MQ8jgcjpYKiIqKErW5ZsGCBaph8NKlS6oHplevXg0BvccweOXKlXC6v/OE%2b/bbb80Ean%2bwQbQqOAPxvBlZKcp56rciDPZet25dMpRgxnawQmvBAuAcA6HBfitXrrQuXLjQIvqXLVtmnT59ugmr16uoqMiek5MTgGSK4bAi1qysLHNlZWXfTZs2hc%2bbNy%2bI%2bjE24YJnzJhhRv2RgAq0G71TnxiXvt28eXM40dIYNBb109jEA5ZgR7KWBDqTwBGQbCQjrCKFZBayEE/ISuOaDx482MOTAkzdunWzFRYWxiI1thAhERHQO%2bqE4FmzZiUgUQrBb4vAEYBBYHZ2dvycOXMiIUyQOw7jdYXQYaAL4n0Mt3z58kAIZAM%2bhr5T0tG34BcOuq747VIcV14Q8SKeWKwWOJINzjxk5syZiVCAReBEm5GR0Qm0Ua398TQdR3kKL5TJDQVYPODIvB8A2FXGHAYYoIIb2gruLvrjrVbkfIjyOA848kXp/N7DfQ5P8L9Q9/x0xGMymVjMnjZtmpybm0s3RtKkSZNkPz8/fzyMIf2eOnUqcyohISFePj4%2bnY1GI/MB48ePl2EpdMQmrVixgjLNIL1eb%2bQXsTL9ZepLL70kYXUls9ms64AHjonCsAQTlp555hk2rsFg6Ai6QKyYtHHjRonGpLG5nAYkcMH0fwd0vghrkTMzM2V6T05O1pCsFovFm1e7rL9Hjx4ab2/vYOD8fk7/JdKVr%2bad/8%2bR2zShG31oSwX/1ML%2bH2FP9PySBpZdAAAAAElFTkSuQmCC' /%3e%3c/svg%3e\" width=\"450\" alt=\"png\" data-srcset=\"/assets/static/output_4_0.9377235.f04b0e4.png 450w\" data-sizes=\"(max-width: 450px) 100vw, 450px\" data-src=\"/assets/static/output_4_0.9377235.f04b0e4.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_4_0.9377235.f04b0e4.png\" width=\"450\" alt=\"png\"></noscript></p>\n<h1 id=\"our-goal-is-to-align-a-line-to-this-dataset\"><a href=\"#our-goal-is-to-align-a-line-to-this-dataset\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Our goal is to align a line to this dataset</h1>\n<ul>\n<li>why would we want to do that?</li>\n<li>we can use this to infer properties of the dataset</li>\n<li>we can use it to predict future behaviour (extrapolate)</li>\n</ul>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> sklearn </span><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> linear_model</span>\n<span style=\"color: #81A1C1\">from</span><span style=\"color: #D8DEE9FF\"> sklearn </span><span style=\"color: #81A1C1\">import</span><span style=\"color: #D8DEE9FF\"> model_selection</span>\n<span style=\"color: #D8DEE9FF\">model </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> linear_model.</span><span style=\"color: #88C0D0\">LinearRegression</span><span style=\"color: #ECEFF4\">()</span>\n\n<span style=\"color: #D8DEE9FF\">X_train, X_test, y_train, y_test </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> model_selection.</span><span style=\"color: #88C0D0\">train_test_split</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">data</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">],</span><span style=\"color: #88C0D0\"> data</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">],</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">test_size</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #B48EAD\">0.2</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">random_state</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #D8DEE9FF\">model.</span><span style=\"color: #88C0D0\">fit</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">X_train.values.reshape</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">),</span><span style=\"color: #88C0D0\"> y_train</span><span style=\"color: #ECEFF4\">)</span>\n\n<span style=\"color: #4C566A\">#For retrieving the slope:</span>\n<span style=\"color: #88C0D0\">print</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">\"\"\"</span>\n<span style=\"color: #A3BE8C\">Model intercept (position of the line) </span><span style=\"color: #EBCB8B\">\\n{:.2f}</span>\n<span style=\"color: #A3BE8C\">Model coefficients (slope of the line) </span><span style=\"color: #EBCB8B\">\\n{:.2f}</span>\n<span style=\"color: #A3BE8C\">Model score (how close are we to fit a line to the data) </span><span style=\"color: #EBCB8B\">\\n{:.2f}</span>\n<span style=\"color: #ECEFF4\">\"\"\"</span><span style=\"color: #88C0D0\">.format</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    model.intercept_</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    model.coef_</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">],</span>\n<span style=\"color: #88C0D0\">    model.score</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">X_test.values.reshape</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #81A1C1\">-</span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">),</span><span style=\"color: #88C0D0\"> y_test</span><span style=\"color: #ECEFF4\">)))</span></code></pre>\n<p>This gives us the intercept $b$ 6.69 (where the line should be centered around) and the coefficient of $m$ 1.35.\nWhich given our modeled loss function is a score of 0.27</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">def</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">make_line_using</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">b</span><span style=\"color: #ECEFF4\">):</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #4C566A\"># y = m * x + b</span>\n<span style=\"color: #D8DEE9FF\">    x </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">100</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> m </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> b</span>\n<span style=\"color: #D8DEE9FF\">    df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">np.matrix</span><span style=\"color: #ECEFF4\">([</span><span style=\"color: #88C0D0\">x,y</span><span style=\"color: #ECEFF4\">])</span><span style=\"color: #88C0D0\">.T</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">columns</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #88C0D0\">,</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">])</span>\n<span style=\"color: #D8DEE9FF\">    line </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">        </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">        </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">        </span><span style=\"color: #D8DEE9\">tooltip</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #88C0D0\">alt.Tooltip</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">title</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">b * x + m</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">)]</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">interactive</span><span style=\"color: #ECEFF4\">()</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">scatter </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">line</span><span style=\"color: #ECEFF4\">))</span>\n\n\n\n<span style=\"color: #D8DEE9FF\">m_guess </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> model.coef_</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">]</span>\n<span style=\"color: #D8DEE9FF\">b_guess </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> model.intercept_</span>\n<span style=\"color: #88C0D0\">make_line_using</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b_guess</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 450 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-3'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-3)' width='450' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA0CAYAAAA62j4JAAAACXBIWXMAAAsSAAALEgHS3X78AAARe0lEQVRo3tVbCVhURxKeCwYYOUZgYBAQhkvAIxM8wCgaDzww8VyN2SUac7jGAxRERUEQAUVRiUlMVBTkPuLBtazHZj2D0ShGzpkIiheecddETdzd2aqme/YxPNR80eC%2b7%2buve%2br1q66urq6/qhsEgpfrEXbu6EIyvtDGxkZ48uRJwYULFwQajYbUhuX7778nhbX5%2bnD7GtKSkpLImL6%2bviKoYqBsgPEToHzo5eUl0ul0gs2bNz8TL773XPm477RQrjZfFCSlHxLsP1b10qy8BxRvWqs6SwhcCWco/eVyuUt9fb0FrL6lVqu1BM2RAlrEYgVtC2xTmgXUVvSdBetHayuD33o69kXezc3NFrDaRrQYY7l06RJ5h32exMPgN5PJykAOIl8jtGvqNKTgGCnZXznsPXTavM0OEIlEDlAHgFn2ys/PH3Dz5k1lQ0ODEzBwhOIADN2gBEDbHooTtPGdPdT9oHhDUSINCvZ3hjIISjfsizwM6fR7pzNnzjhUV1era2pq1FVVVUoO7260rzP91pHyakOnYyqpDP2oTE60L7YDqus0nvduXrHT6e7ZrNy2f8rclJK36zXaXrymABoSx8TEOBnSgZkYmfLQUSFmPPTufPz56ECTY/mNPMxQFkP6uZp61lf4eljW6MAFmWr8cflSk3Objk5OrXNbuXKl6dq1a8leLCkpEQFTIR3AFAqhg1aRLqJ01LQVbQupw0FledC%2bQlr46IyHHRbGG99Rugd%2bQx2ZkI/Okc%2bKLdDNa82i7PJKceuC/mT/0fqSXmMjcydNXlGgZPPVar9v62/s7e0Jo6ioKFSAK7YzMzOJ4FQwE44ChGxgaoKWjM6ZhDttEw/MR%2bf0V2DhKIb1d2eKTtt7XPDtuTo2WXemPI5ScN8TBcRuPyBm81qYWjZt2sqiYPZ71Y6DEvqda0dbQBQbG%2btsSIcPJFCceUwP95%2bMpz/vAHx0oHXFwkN3eVYejY0XZA0arQP77ffhTqtB83aNTco4FPQs20gEGIyTexVwuEd6enrPR48eyWpra62oNzXHFYK6N9Rm1NysaNuHOi4ZBxlwT6vxOw6KtKNT3mbUwbrRNuuPfdRQy3%2b4cdk8v%2bKbrifP1lhx6dTLWzY1Nsqqaxu6X21u8sLJvLdm78D31%2bybCd7eTvfolntVdb0SlGPOeEORodNsi4MiEWoksFevXr45OTn%2bt27dUgIcOlFP64BmB2UgQwFacO/2p0pQcjw%2bemiut3fsgI78kd8rWGhbjwLY93xtg8s/bl1RhqWWTf/8y6Ov6nT3reHdYA46OJ09X99N99MNFUx08LwNJTPmbSgN/tf9FvvH/2yxqWvQDKLKdeAgCbb7PAkFHPlQAAfkodu9KBS423LZ0TNkq2zwgl1DGS1gbsbgLw%2be6m3Y992kvR6zkva%2bZzZ2k7XBdsFJi3nGbLud3dzceFGA46hMoag4zkyPAhiYcJwj1qisNijAR%2bcgiR4FkMbGhADG/a/HqiTTYgsxSMLFEQxbmNXlzHd1PfIqThox2YPCcwaC2U87VVVLJhUPjg5MnvFWIYIZIg%2bbi/5xcHAgg0ZHR5uuWbOm01AAnJkQzF7v7e%2b0NBOBy4%2bcFZymKPDo3nViRWOX5Fq%2bsTRv4tDQLF%2bM8K5dvkgs9Ke714QarR4eVSg7z5gdooA4Li7upUCB2noNb24Q9XnFiJGLsl8Zvig72Pfd7RZI%2b/pMjTmsupKHN/oKCQ%2b9u2EojB/79OnTxzUtLa3n48ePOwUFmhovWIIFWP7lyFkTWGkfcGQW4NwsD39zvissjlSn%2b8EYApuEP68rnqzT/Wim0z00O3bqvAW1RB8aEXLl601lN6c5S4cogCszGmBQnZeXR3KBF4EC3FwA4nFniMgwXicoACtof6flskP%2bX7/xfidhd%2biWoqPvZJZ%2brdb9%2b44tTL7LJwVHBofE704CSJwAv63BzB3r6jXO4CuUVIb%2bVCZ9LkBlxsDJgeUOT0SBGzduSMAR/q4oAIqQwyT0KDBwXobvyPDs8Oit%2bwcJfFdKBs3f5Q/Ob/rQ0MxhPd/drtQ9vOnQQS5gx2Pqz4YC3t6tFgFR4O%2bCAvhMXVmoFAxMMobJK76radAnMhNXFKhGLc4JgFU2X7vrK5NxS/PeAWf3NntfU6/xvNLcJKYHH0w%2bfS7AlQ9lRtmfigJBQUFMASYMBaAWcjw4ooCrIQpQ02YowLSLyZI7XV39GIdOnBOByRP6%2bKh8izeW5Q21n/wJngmY4mRfm5fRB%2bgEjyFrs1j6WcXEN5flzRoTmdsmJG5s9Rci7ph0bztykjImnytDAboIejrvFjh69KhRUlIS0U5GRkYbBTAPzh3gaTB463qz4NPCI1zP7ok1TH7EhOX5xGSnx30ZOjNxT/CYxTmRsNqjofjDpEfOXlccOnF5fs/gpbk9wCpkTDngKzwMkyHq4Jx4YLqNAjgL11YBEokEAwuVWq22TUlJ4cv7jTuI4vCAwtyAJmAxA3t6zNhqMmlFgTUzvaCIbHVQeLaK4nl08JK8CNqeHrwktwggbgxYhd63BIZm2gZF5JAIsL5B68YWhjMmIks3Pp%2bDsvPQXdqcxhobG%2bMk/gQoMKCgoGDw9evXXRsaGjyoB8V95AtlKGZouI%2bxIHPq7RHaXClSoHCeQB%2bOSoAV9/gZAhdITAZBKjoKvPrM0E2lf4TJKeJ3HhwZ%2belfRkCs/0pmWeXYkNW7I6dEF5ZPiSncsbngiP%2bB41Vvbcz5%2b8S9h077QazvpHtwE5HDjfL2pGO507HVVJbuTD4q61Aqu4rOxZ22/Xi3QFZWljQ5OZmY2uHDh8XUnJmXdeOcDolZoMHieLr30fwwaPJMzTtMwtdGaq74nPi2uies8lhwgF4ZpSck4N17wyT7QPYWDZ5/PChBBjG9MVhBPPiA6BkJe1zfXvWlFfLZWXxCgjWdvISOxZyxnAVqXPmoksxoFCji0PUWilGcHiZWr15tAj6A7A87OzsunEiZD2BHzQxmMMjhKvHSxUYhc3ZjInOk3aZ%2bSqwsvfiEGB0YNfV%2buLdHReQsBx%2bwaXpc0cdDwzL7gNOzAx/gDcp4LWHnwXE44dZHxZXFje19Ds2CwbSBfOgDpJx%2bAkMfgO7/VfYjPj5ejwIAh3onCHVHThBx1pLtfXz%2bfvI70fUrF117zdpuCpMJgYkSJ7Rtz3HJvZtX9HsP3r05enHOVFDAJDD75dCeMG5p7lhQQhdymvNxWTA4P%2bKPwGHi3tefFHFgWMA5EXLkc4Io%2b1OdIHtyc3ONfysKVBw9K374wzVnMG8lePt%2bXP7zN5bOAQ8/DCYfDtj%2bUf85O52SMg75tVy5ZN1/TroTbA2yncQjU8SQCFEhPxAA7mOi1E4Bzw0FpFIpbgPz4OBgC7CA7r8FBXS6nwUardaN48EVsLpvT44ukIMCIsDsF4ISFgYu2EVWGnxFrx37TnjAFpgB7/S2fvZ8nQdYxChBQKLEYEzV80QB8hgZGeEqhnh6egYUFhb%2bKhSAQlDgavNFFSQzDAWGQVLjDqvmpvvltlNYatnsabFFeQs2lu4MTS1bFL65PBaSGSXECIEfJu%2bL/TjvMMT3Pzg0NTW6aemYUA%2bHpMgPTN%2bdBj/udPLPHwUA/ggazpo1qwvEAapnRQF62UHMNjS1VJaYfkjy4O41cXWdpgcNdz1g/44Cc/8AApnF4AcCgpfmuUBM0HdKdEFfiAcGFe4/5ZxTfpKYJECfGJyo6PS5WjRfT3CCQoBRIcCfiCPLc0UBdg5A6i1btkgTExOfGQUw/MT0FdsAXSNh33elFw8q64kfI5xFQNkBUZ5fzPb9Yoju5vSdvdMMUOA18AMDsS9YjeL%2b7avWrYcd17hm6nbo63MingTnuaIAed5//31Sx8XF/SoUoKkuUUDUlgqhZ8hWInBWWeUA2OeJ45bkTQpelqOH2eKvvu0/fGGW%2b/jl%2bZbgIAORBmmtAlZYQdtc4bnOjpf%2b3FBg2bJlpP7iiy%2bkvwYFMAPDQwwuLzDv3qGbyt4DBfiB2esdE2yFwO17j/fH9ux1%2byQAcc40ucEDCwX3dolvoh0o5vmgAGUunjFjhgwU8MwogAcNx09XEwVIh28UBoXnDAfTfv3f91scIQCSvR6WaQPbAjzuHBGY/cjkzK8CeXjbAB8bHno7b//CUMDExARz5skeHh4Dn4YCeDeHqwBZmQvAXaDu8W3PtL3HA2YnF8/%2bJP/IKJ3uvgN68OaLja4Yw0NE98fSw2fUGP/fuHppCCYz%2bD3UntRrD4B6ABXW/Qne/sWhAH26DBs2rGtqauoTUeD65YtiSF7IsTRMXgHYPmrM4tzgD5L3kYOHogOnjEE5XobMs8srpUBHz46Xk1yPbM9udqkHb%2bft2YXsC0OBsLAwUldUVBgnJCS0QwH4QMru6iBZafXMvrFGf15XPBN%2bc8x6hgCyN9GPd646By7I7AZmr2BvIJoTMiUaHGbYYuHSOvL2LwwFVq1axS5GeFHgYlOjSV29Ri/8hKh8z9fDst4Ap%2baHR%2bnkBGnX34hQ%2bRXfiMEHOI1YlO0Bnr717E30EVsBdx4hubfDnYMCAH8CegyGCtCjQBONvw%2beOCeDSREnM35Z/ggoI8kW%2bPm2ovJMTVeqJNIX4noRntow3tFb93d0YdLuYqTTUIA9sP8xEOI90QVs7zdkQeY4iOv1%2b7umTuMISmqTC5w9X9/%2b0LGDkyKGAlg6GwXw%2bGkC5AL%2biAI3Wlpcvquu9cK0VvevO45x2w9MWJV2IAZi8z463T2H6roGL%2b0znAgxz8vo1IOrOF69O0WAzkUBSIbQq3fz9/e3RRRIoaHxos3lmNMHz0zcM%2bw/P94geyyj5Gujq81N7XIB7okQVQK77OSlv1QooD%2byqjxllJS4mphHcGSOK8Txk1%2bbt8ueHnGrWvOGx9zDiXYnQvT83Y3He7ehv1QoMGTIkNYTodhok4SktW6jIgv8xy3JHT01uohobP%2bxKogD/hcKc5xMuxMhnlvgp9E7HwUYc916geiDmK1vggLa3J3V1daYaDStt7VlZWXC8vJyIgD%2bLWFdXZ0lPU0izI8dOyaGvu70kFWYnJws4KMXFxcLKQ8FFpIsAQ3fkcQI%2buI32EYefHQ2JsqAspCrdJANZaR9VdXV1aY00xUyularbasAFxcX/fV4UkK8I9%2b1%2bd27d9vdF9y7d8%2bee37Pntu3b/MiCR/9wYMH8ocPH8p/Cw%2bUAWVp91cmIDOLU7hPS0uLMx9vO0ABv88%2b%2b%2bzV2PhEa0iK7CAmUMTGxtqkpaU5lZaW9luyZIkcVsNu3bp1dosWLbLat2%2bfGlbBDbLJrhA4KSCKtN24caM9aNp/9erV1vg9FqRv2LCB0CHossG%2bwEcREREh3717t09RUZHP4sWLkbcC32Ef7AsO2Q6/ZXyQJ6zwABwD6dgXx0YZUBaUCWVDGVHWkpKSfjt27HDCOeD3mzZtsoW2/MCBA735FGDl4%2bOjSklJ8Vi%2bfDlhDkpAgWyioqIcYSBvYEImhXQYyBr6eQLdBdu0ry0IaQf9fWNiYhQcHjgJQmcTQjoIah0ZGekRHR2tQt5IoxO1xb5AV%2bK3tK8t/FaAonriGEiHmEWxfv16a%2bjrAsWLKx%2b2QT5vlB3ngHRQijI8PFy5YsUKlyf98bQP/tWMAa0bPUI3fMZCecWAhoHHFNxZBnR3Sjf07MPx7NSAhrD8ByoL98F7jDcxcTOgoxcfzyPfG3jjzr0IpzL4djh7c3isrKxI9BQSEkKEVSqVRmZmZvKpU6cKt23bJqisrBQEBgYKjY2NlUAnkeCkSZOE9O%2bNJFKp1M7S0pLAz1tvvUXocrlcampqat2jRw/yPwELFy4UYt0FHplMhrfEgvnz5xOaWq0WQXBmC3QzJseePXsEffv2FQHN0tbWlmSjU6ZMIbyBryX0t8Fv4%2bPjBenp6YK5c%2bcKkQbvCEz/8ssvKIMxhDzIV/Yy/ZeIN2elhYL/s%2bd5CIxBkOL3Fvy/7ndS1fzZMnIAAAAASUVORK5CYII=' /%3e%3c/svg%3e\" width=\"450\" alt=\"png\" data-srcset=\"/assets/static/output_7_0.9377235.fb010ac.png 450w\" data-sizes=\"(max-width: 450px) 100vw, 450px\" data-src=\"/assets/static/output_7_0.9377235.fb010ac.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_7_0.9377235.fb010ac.png\" width=\"450\" alt=\"png\"></noscript></p>\n<h1 id=\"now-lets-try-to-implement-this-ourselves\"><a href=\"#now-lets-try-to-implement-this-ourselves\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Now let's try to implement this ourselves!</h1>\n<h3 id=\"naive-approach-to-guess-until-we-get-a-good-fit\"><a href=\"#naive-approach-to-guess-until-we-get-a-good-fit\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Naive approach to guess until we get a good fit</h3>\n<p>guessing the beta parameters linear equation</p>\n<p>$ y = m \\times \\mathbf{x} + b$</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">def</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">plot_on_top_of_data</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">b</span><span style=\"color: #ECEFF4\">):</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #4C566A\"># y = B_2 * x + B_1</span>\n<span style=\"color: #D8DEE9FF\">    x </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> np.</span><span style=\"color: #88C0D0\">arange</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">100</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> b </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> m</span>\n<span style=\"color: #D8DEE9FF\">    df </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> pd.</span><span style=\"color: #88C0D0\">DataFrame</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">np.matrix</span><span style=\"color: #ECEFF4\">([</span><span style=\"color: #88C0D0\">x,y</span><span style=\"color: #ECEFF4\">])</span><span style=\"color: #88C0D0\">.T</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span><span style=\"color: #D8DEE9\">columns</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #88C0D0\">,</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">])</span>\n<span style=\"color: #D8DEE9FF\">    line </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> alt.</span><span style=\"color: #88C0D0\">Chart</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">df</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">mark_line</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\">.</span><span style=\"color: #88C0D0\">encode</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">        </span><span style=\"color: #D8DEE9\">x</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">x:Q</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">        </span><span style=\"color: #D8DEE9\">y</span><span style=\"color: #81A1C1\">=</span><span style=\"color: #ECEFF4\">'</span><span style=\"color: #A3BE8C\">y:Q</span><span style=\"color: #ECEFF4\">'</span>\n<span style=\"color: #88C0D0\">    </span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">scatter </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">line</span><span style=\"color: #ECEFF4\">))</span></code></pre>\n<p>Our guess</p>\n<p>$ y = 2 \\times \\mathbf{x} + 1$</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">m_guess </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">2</span>\n<span style=\"color: #D8DEE9FF\">b_guess </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">1</span>\n<span style=\"color: #88C0D0\">plot_on_top_of_data</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b_guess</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 450 364' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-5'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-5)' width='450' height='364' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAA0CAYAAAA62j4JAAAACXBIWXMAAAsSAAALEgHS3X78AAAS0UlEQVRo3tVbCVhV1fa/AzPKJNzLPFzuZZA0UXg4FEiYM5DmgL0MtbTMzAkHQAERFYcQJUXDnAVRwgGlcrbnnBoiCoLilGl%2balr/9D3rfff91maf%2b869HFKfWf3P963vnLPuPnuvvfZevzVskMn%2bWpf8zx1dzsaXOzs7y48dOya7ePGirLa2lt1N6cKFC4yEZ6k24ramvNmzZ7MxQ0JCFLilgXIw/kzQiMDAQIVer5fl5eU1yFB3QXbruyuy5ZsPyfYeOS377tplWV0TY4pluvCYNkR/lUsHCuZ3zZ8lBK2ENyjM0dHRt7q62g6rb19XV2cPjTGCxogc8GxHz5xnh7sD/81OaMfvDibvBj61pb6vXr1qh9U252RBdOXKFfYbtaG22AH2Vy/X263bcVT9j6/POJ2vrbMHOQr9CXLwdwcTOez4eIa2xOO/2xhrQKHwwS2yVatWIRs2bIi4deuW2/nz573Q2BPkjg/8QR3w7ArywjP95op7OCgY5EY8ELX3Br0E8qC21Icpn3/vderUKfeqqqrQs2fPhlZUVLgJfYPo25cwWR%2b9/pHTpMWfJxZsPhQGJdnXX7zYCWbgQ33ytm5chnAukxcfl547kOw0By4HtafnFyW3AgZQpqWleZny8YGSOpXgk0JsJPg%2bUv1L8cFzJDLl37l5zVP75jLblz9cEyXw2r%2b/KmLL3hOtJPqwIVkk%2bKQIpSkfSjCWw9/fn93T09Ot58yZw2yxrKxMgY/lvCNrkIZ/THyFaAAH/iznQEPK0vG2ck5SfKEPNZHQN/1Gz5fqL2qXbzlk0Se1uLn%2blzu0OLKuSetVxyvOtdTrHyq%2bPPiNTCSfg7BAJJuobw3JLpJPwccxxpusrCx2B0JbZWdn%2b9Ez7nJCTf6BFZ79BOFFA9O2sud8QeukIC1/lgl9NMXHdyoiifZavf5HNs7Q2ZtlOw9VMP63Vy9pTp%2btUYjH5HbuKZqoIJ8fyS70LeYbKcDHp2FHYPsbdkBpaamhI9ytBa3RAMIO4DZlL1IM3ZWiicpFbsmIL%2brboADYt/xcTa3A19acr1NmLN/JJnr5Uj3jV507HwBSPvrxpmEHcCD2Eila4Bt2wJXL9fLTVTWCAjRNYgDMwEvCZpTCACZ8SQxoZGO/wQePUL0RBkARflJ9vJ29ZaCsZZqZKQaQLE%2bKATAvb6M4CF7ADfcXQkND/VevXt32/v37TjU1NWq%2bOs58pcNATiA1JwKvNtxDOPG2LlwpEfw71WP4NPmWRASEWGVVRVWNGm7P6eEP37X56fZ1F3qHMtTXr1520esfND9ZWd0JO8MVu8UF36j42P5cFkdBPrwTP6yu7oI3vlHhW3uYj9OIuVvb4b2dSSAoJxTsrtPp2hQWFobeuXPn%2bSjg4sUI/Mb4JDxNmk%2b%2bJfl3IL/zxi%2bP%2bw7OKh2%2beNNXA1dsPRyMXWmr1/%2bfPdDfd0zujr7YyuH19RfVcIUuvG8jBQigCgU5Vp%2bv%2bxsm7Yk%2brHMK97d9d962d7CDOly5VP/Cn2ICUm7Q1AQ6fbA6%2bNUJ68cm538R6ffGUtuXRq8Ja/POp%2b4Mqwbl0%2bR8n9QNQnEuCzccsOo4anXH6LFrY1z7LWaAWGcqh4eHBwOHqVOn/iEgOG/dPiW5NbpqauvYFhdk6TN1oycUAFf3iMxS1nvKhpDYKRviRJPVkl1fu3JJjOoGEMRKG/Bh5qo9rwzMKBnUfWKh1kTpxvgya9asP8QNErILY8Ymb4gKeqvAGT7d7uc711sQb3XZYflrKcX2UECr2zevGq30yPnbBN%2buFfl59htMwg5KNADb69M22XcZv77blPwv3kASxVZ9QHqJAtgi7QZjY2OFQMiggMWLFxspQNCaENzw50YK4MGMlq%2buTFjp7QdOKfGu45N/8bXUYibwjgOnvL45U63uMmH9CPBfHphZwlB79ILt/dEmqOfkomCT1dMKO/D2jauMd%2bybs476X%2b8wVxqfUhwRl7zhteAhBU56/c/quzevWTaYwy%2b09aUVYHA9586ZzZgxQ8rGLJpwYZQnNDfhNY60/uvamGK6JhWGvTJuHRM4LqV4Tp%2bpxUO6Tlgf3WNSUVSvyUXxIUML7JH8BODZDeFvC%2bCCU7ekwnBqD2DzN01noWRFXvFXYS%2bPXtMD2z1U4FeePe8Hj2EhIbfxHK2trclufCIiIlyXLFkSiA7NKisrKfy14pOnUDMIdzMKLDgmEDBqORITn3aJJWVaoBD6DgGLtV7/b/NxC3eoPsgp08D/BtF4w%2bduDQMaB9LzmzNK30uYXjJy467j5gPSN3WMSy6egnsnyOAu7J7MFbtdxi7coSGQhlsLwcRsDxyrZAHOtE92Wr43b1vf8Xnlb09e8jkLy785U2Oz61CFOeQI4mGyBZeP5DYD6YwUYG5ubkeyBAYGhm/cuLHTzZs3vZENamjb08rzjiI56Gk4UYbXEffWIG/O8%2bMuqTN9hy2v%2bee9G14ApoislbujVm07PAwTGYCJ2M1YubtL0sflr%2br/dbtl0efHumESPd6aWZrdP23TTCB3OGy330fr98eW7v66za8/3fRAP55wlb5Y0Vfu3foWWeIPrrlF%2b3tDkUPzS/7RG3FDO/DdoHQtl4WCoEi%2bcDQHPx4a%2b%2bDeVtIEcnNzLTIzM6WyPrOnyQYbbTF%2bfV1xTgd31BXujeFGUOInfqvLjngh3A3zHZTvSmYRNuJTs5hx6xInflw%2bGu%2b%2b8i7zrY23%2bwNV2Lsrm0WPXfcqqKNgApVna9ybiATNHuumhw8fzu5wgQSCzH63bt2qkHKDHOTEbtAoGxRMQ9z/sNlb5AhwzOo5H3YfA3cXiInGYwt3/2BB2fsdRq0O5CDmBSxIxOoaXN/4ReWGcDZ9%2bc7XAY594lM2GFznqcpqR3EuIM76SHbTDLQRRiUnJwvu8JndYG1tnQJ2quU%2bPLzXlCImwKETVQpEer4iN%2biG9Lbb3zM/S4SvngZg7In2sSAP%2bj0pr7xHn9SNPqL2HgC4uIzlu%2bIFHsJaxe%2bSDSYmJrI7PMAzK2Dr3pNK2KN31Ji1rpjMAMaMmS9fX35UWfzl8XayqDlKrLIdJqSVaVOVCG/bvzd/W5fID9do4L48BZnWbj/C4nXd4GVyeINo9NWj9dvLAao/upftP6mUNRuDrf9Q2OrPpgDhKioqskAwxLYHkiLJOMAklTWKBLmdK298e1kT/t5K675TNxpleYjFJ/aYVBiGyURjsjFwcf4rth6iqM8eIe%2bL/dI2qkS27gZADMHkX2fK4ldV9fmAer6V6yTSYfECcVC2EgVljRTQjEqCNjY21GHzXr162WHlpcpWFk2Us6h219wYpO5SOdtfeMdOUGPrjo1PLfZdANTGRDV4T2g7YgXzz3PW7A1dvuWQLvLDtfGIANkqth2xsjkCoWGYfJJ7/yWWPL4TFkNTXVNrKkdzkkUq9yDZJfgGU%2bwGam1ra0uDvBUQENBh06ZNL9%2b4ccMPblDHw04CkhAQuTZf8qFEvHMqcoYSH5MmHgUpAaAYCliQwmr%2bdf%2bG96xVe2JhrynpBTuzx%2bRuH48QdTK2ryuyvY6jcsrS4fbigeRW%2bp%2b/95qxYnfCO3O2JiJCHPTLjzd9kCJrEEDpeARIBY4YUACNxfMCPy4DyeIjyMdl7cxl1/C5aPlzO%2bPivI7FBRbDhg1r9tFHHzETOHDggJIjvpBt%2bYsKpEq%2bGt7iTI4CF6yOGfw/Q3SAmx/I8/VpG937pBYnbNlzoh1WNRjvLyZklGgAgtG7Dld4nDl3XtV5zFo3tOkPswmjb%2bH3ffccPm1%2b4vQ5OdJXBUd3GZ%2b8mTgp42m1t6l8XEk23DspRHyNaSjJ7vn5%2bZbwBMw%2b1Gq12G9ainIBceLjCZtkGICJRcHHM5cIJeg4rzNi%2bb/DrXWC63IBBrxJfPDC4B260vNXx8%2bosd37dh67tgts3VYYEwGPFrtKLuHD/QW8EfHoDMDTVD6OAZbiMF0SBEeOHCkURw1eADGBXJTJSYIgKYAOL7j/dkLezYIOrFpQt4mF8QC7REy0Zbt3VzLNz1%2b3Lw7uLhwTdYdCnAkPEMlRCBtuiEnmGFybVpR2iyfVKBvk6bCnFAiS7L8FguxatGjR/6QAcTYoXD/dvq4gm0WQ44dJGgEkQlU/QVlQznQAXwfE9a7I1CgUl60pOyLX//uuzDTtfe4K6NmzJ7svW7bsqU2AjpvoGavJeIs3faVEnO6OMFWHrd5aFMj0mb16TzTSXnJtffDOagDXrlxyPn22Rs0zvd/c6s/NBITa4JAhQ54aBIVTHaEcDZMwq6%2b/qOufvskM6G4OwGNKALh1RsKTgtU3OpaqazjCchX13QjshMOY5waCSIdpm/TVarUvlZSUPLEb5K4nlLsiLXeDOoTCXc4i90eAo567dl8CQO6dKUu%2bGHSysronIjlXZHU6gFwAz8wiOPnwPppyd8/PDTZr1oy2lF337t3t5s6d6/0sgdDQWZsVP3x/zaeh8LE%2bAGDYPWb8OhZ4fH/9ilSxxZlIgq8RbPxx/GcJhIwuBEFPFQrzdJOBYPaavYrgIQWsfdm%2bk20Q8sbBzmOGZW9m227ltsNmFCzRM3aA%2bFRHfDQmbwrspPgiMP6fQ%2bGGrGrEiIbKS2bmUyVDBDzI/oy8AGy8w7hFOxJ7TCzsBaRnuylkaIHiu2uXn/psUGTjkvzf7WwwNTX1idNhDj6sI0Rw3khxmQnEJRd7APXjKZJDNshMYND0EjPRtvvrKgARoIxP2ko4FzAtiAjIiZWUlx84pRQOHvYdrXRBEhMZl1LcE36/Ga8G64QI88Tpajmv4SuFWpxJLMFOmiR2l45/Y6R0Uz7nOYhM4OkLIsKVl5dnMX36dMmSmNTJ0KTFn3cckL4pITDxE68nKYk1carjRPSkQPU0J0NPXBKzsrKiul5vZIN/ExdFuYthRVEAV2eAmDfV2rfsPdFmyKzNA3MK909A3N8ark2FnIBid0NRlH8nFCL9eADTWShQCoVLfuYYJiq4CoXYzvwbcR9GfN6eErLWvEDrKSraevFC7uOLopaWlua4%2bbZv39516dKlhrJ4PeznbHWtxfGKc06P7t%2bgsjS5ucg3Mj9LgGtT6fU/uV29ckm1ff8pC6SthBOWPPAI4eV0K05G5XLOE0rrwt8FKTlPKMWH8G8shX5M%2bTxEN%2bM4ohX64KV7M14RfnxZ/HEHI3Qt/exgh6gxa3t2n1jYRuBVVNV4YdWf6GCkKX5TcQBfRdmT8Olwhg5ppLa6VBzQyESjo6MbHY29n7WKAZ1DXJ4SOX23D3O3J3oOWMIQdVXZEQFMPIU4QOpozATtjfgiRGZH5eIDVqk4QIov9gLiZEgEsE/mBTDphrJ49iyrrNlzDOUs%2bPEgrPhrI%2bZubaXX32cgk5z/hfLbq5fkomTouf2N0B/mBuvr6xtQPXW6Tf78DI%2bI8dtsYqcUxfaeUhQluLPKqmom/O4vy%2bU7ysuZAPS3hNXV1fa8oMo6P3jwoLK2tuEMcN26dXKE1jIp/rZt2%2bS8DxURPROPfmsor9dq6Rt6pj6k%2bMKYJAPJQs/lkG3Hjh1CW01VVZU1d/VygV9XV2esAF/f/74Pn7Y0OmZiSfeopFKDa/pVrze/e/eup6kt3bt3D7m8vtHJ0O3btyX/QEKK/%2bDBA8eHDx86PksfJAPJYsqHzF50nmjKJy8n1bda5%2b8XOiPnk5jMGTOd1uZMsc%2bcPc81I2O684pPP/Xavn17%2bOTJkx2xGup58%2bapx48f74BgKRSr4J%2bcnOyEAEo1c%2bZMlwULFrhC0%2b2zsrJawLRURMTPyclhfITbztQW/aiSkpIcS0tLWyIDbTlx4kTqW0W/URtqu3DhQjV9K/RDfWKFI2gM4lNbGptkIFlIJpKNZCRZy8rKwlesWOGVkZHhTN/n5ua64Nlx165draUU4BAS8oLm49y5mqmpKS6zsuepkRiRQM4pKSmeGCgYnbBJER8DtUAIHQC%2bLz3zti4QUo32IWlpaWwyAh/fMb4wIeJD0BaTJk3STZs2TUN9E49P1IXagu9G3/K2LnhXQVEv0BjER%2biumj9/fgu09QUFiuWjZ8gXTLLTHIgPpbhNmDDBberUqb6/9cfTLemvZkx49N5Voi2VktqY8Mjt9CPLMuFrOd%2b0yhNDf6dswqO4pD%2bXRXxR0TSOn2eIL8KqeAn56C8/Ooreg7kMIU3OvjkuBwcH5jsHDx7MhHVzczO3sbFxHDBggLygoEB29OhRWWRkpNzCwsINfBYH9O3bl7V1d3c3Q2Cltre3Z6WohIQExnd0dLS0trZuERQUxP4nYNy4cXK6N8Nla2tLfzkuGz16NOOFhoYqEJ26gG8jyLF582ZZWFiYAjx7FxcXUpCsX79%2bcl7QsUd7Z/oWcYxs1apVslGjRsmJh99Yye7Ro0ckg4W5uTn1a/tX%2bi%2bRYNFKy2X/z67fQ2AXkOqPFvw/lus17KYJkvYAAAAASUVORK5CYII=' /%3e%3c/svg%3e\" width=\"450\" alt=\"png\" data-srcset=\"/assets/static/output_11_0.9377235.4a663e8.png 450w\" data-sizes=\"(max-width: 450px) 100vw, 450px\" data-src=\"/assets/static/output_11_0.9377235.4a663e8.png\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/output_11_0.9377235.4a663e8.png\" width=\"450\" alt=\"png\"></noscript></p>\n<h4 id=\"not-the-most-sufficient-algorithm-but-might-work\"><a href=\"#not-the-most-sufficient-algorithm-but-might-work\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Not the most sufficient algorithm but might work.</h4>\n<p>hmmmmmm ¯\\<em>(ツ)</em>/¯\nlet's think of another approach.</p>\n<blockquote>\n<p>Can we we somehow see if we have a good guess?</p>\n</blockquote>\n<h1 id=\"lets-improve-our-guessing-strategy-using-gradient-descent\"><a href=\"#lets-improve-our-guessing-strategy-using-gradient-descent\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Let's improve our guessing strategy using Gradient Descent</h1>\n<p><strong>Gradient descent</strong> is an optimization algorithm used to <strong>minimize some function (loss function)</strong> by iteratively moving in the direction of steepest descent as defined by the negative of the gradient. In machine learning, we use gradient descent to update the parameters of our model. Parameters refer to coefficients in Linear Regression and weights in neural networks.</p>\n<p><img src=\"https://ml-cheatsheet.readthedocs.io/en/latest/_images/gradient_descent.png\" alt=\"landscape\"></p>\n<p>Starting at the top of the mountain, we take our first step downhill in the direction specified by the negative gradient.\nWe continue this process iteratively until we get to the bottom of our graph, or to a point where we can no longer move downhill–a local minimum.</p>\n<p><img src=\"https://ml-cheatsheet.readthedocs.io/en/latest/_images/gradient_descent_demystified.png\" alt=\"winner\"></p>\n<p><a href=\"https://math.stackexchange.com/a/1695446/196117\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">math.stackexchange - Partial derivative in gradient descent</a></p>\n<p><a href=\"https://ml-cheatsheet.readthedocs.io/en/latest/gradient_descent.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ml-cheatsheet</a></p>\n<h2 id=\"lets-introduce-the-loss-function-or-costerror\"><a href=\"#lets-introduce-the-loss-function-or-costerror\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Let's introduce the loss function (or cost/error)</h2>\n<p>A Loss Functions tells us “how good” our model is at making predictions for a given set of parameters. The loss function has its own curve and its own gradients. The slope of this curve tells us how to update our parameters to make the model more accurate.</p>\n<p>${\\displaystyle \\operatorname {MSE} ={\\frac {1}{n}}\\sum <em>{i=1}^{n}(Y</em>{i}-{\\hat {Y_{i}}})^{2}.}$</p>\n<p>Given ${\\displaystyle n}$ predictions generated to ${\\hat{Y}}$, and ${\\displaystyle Y}$ is the vector of observed values of the variable being predicted.</p>\n<hr>\n<p>Our example with\n$ \\hat{Y} = mx_i + b$</p>\n<p>Now let’s run gradient descent using our new loss function. There are two parameters in our lost function we can control: m (weight) and b (bias). </p>\n<p>Since we need to consider the impact each one has on the final prediction, we need to use partial derivatives. We calculate the partial derivatives of the loss function with respect to each parameter and store the results in a gradient.</p>\n<p>Given the loss function:</p>\n<p>$$\nf(m,b) =  \\frac{1}{N} \\sum_{i=1}^{n} (y_i - (mx_i + b))^2\n$$</p>\n<p>The gradient can be calculated as:</p>\n<p>$$\nf'(m,b) =\n\\begin{bmatrix}\n\\frac{df}{dm}\\\n\\frac{df}{db}\\</p>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">\\end{bmatrix}</code>\n<p>=\n\\begin{bmatrix}\n\\frac{1}{N} \\sum -2x_i(y_i - (mx_i + b)) \\\n\\frac{1}{N} \\sum -2(y_i - (mx_i + b)) \\\n\\end{bmatrix}\n$$</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">def</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">step_gradient</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">m</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">int</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">b</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">int</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">points</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> np.ndarray</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">learning_rate</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">float</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">-&gt;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">list</span><span style=\"color: #ECEFF4\">:</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">\"\"\"</span>\n<span style=\"color: #A3BE8C\">    this calculates the gradient step of a **linear function**</span>\n<span style=\"color: #A3BE8C\">    WILL NOT WORK for multiple dimensional data,</span>\n<span style=\"color: #A3BE8C\">    since the derivates will be on matricies instead</span>\n<span style=\"color: #A3BE8C\">    </span><span style=\"color: #ECEFF4\">\"\"\"</span>\n<span style=\"color: #D8DEE9FF\">    b_gradient </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">0</span>\n<span style=\"color: #D8DEE9FF\">    m_gradient </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">0</span>\n<span style=\"color: #D8DEE9FF\">    N </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">float</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">len</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">points</span><span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">for</span><span style=\"color: #D8DEE9FF\"> i </span><span style=\"color: #81A1C1\">in</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">range</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> len</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">points</span><span style=\"color: #ECEFF4\">))</span><span style=\"color: #D8DEE9FF\">:</span>\n<span style=\"color: #D8DEE9FF\">        x </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> points</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">i, </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">]</span>\n<span style=\"color: #D8DEE9FF\">        y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> points</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">i, </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">]</span>\n<span style=\"color: #D8DEE9FF\">        b_gradient </span><span style=\"color: #81A1C1\">+=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">2</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">N</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">y </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">((</span><span style=\"color: #D8DEE9FF\">m </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> b</span><span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #D8DEE9FF\">        m_gradient </span><span style=\"color: #81A1C1\">+=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">2</span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\">N</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">y </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">((</span><span style=\"color: #D8DEE9FF\">m </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> b</span><span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #D8DEE9FF\">    b </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> b </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">learning_rate </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> b_gradient</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    m </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> m </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">learning_rate </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> m_gradient</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">b, m</span><span style=\"color: #ECEFF4\">]</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">new_b, new_m </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">step_gradient</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> data.values</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> learning_rate</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">new_b, new_m</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">(6.6874785109966535, 1.3465666635682905)</code>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># Let's run through it through the whole dataset</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">def</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">gradient_descent_runner</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">points</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">starting_m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">starting_b</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">learning_rate</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">num_iterations</span><span style=\"color: #ECEFF4\">):</span>\n<span style=\"color: #D8DEE9FF\">    m </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> starting_m</span>\n<span style=\"color: #D8DEE9FF\">    b </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> starting_b</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">for</span><span style=\"color: #D8DEE9FF\"> i </span><span style=\"color: #81A1C1\">in</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">range</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">num_iterations</span><span style=\"color: #ECEFF4\">)</span><span style=\"color: #D8DEE9FF\">:</span>\n<span style=\"color: #D8DEE9FF\">        m, b </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">step_gradient</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> np.array</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">points</span><span style=\"color: #ECEFF4\">),</span><span style=\"color: #88C0D0\"> learning_rate</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">m, b</span><span style=\"color: #ECEFF4\">]</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #D8DEE9FF\">number_iterations </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">10000</span>\n<span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">m, b</span><span style=\"color: #ECEFF4\">]</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">gradient_descent_runner</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    data</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    b_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    learning_rate</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    number_iterations</span>\n<span style=\"color: #ECEFF4\">)</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #88C0D0\">print</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Starting gradient descent at guess_m = </span><span style=\"color: #EBCB8B\">{0}</span><span style=\"color: #A3BE8C\">, guess_b = </span><span style=\"color: #EBCB8B\">{1}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">.format</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    b_guess</span>\n<span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #88C0D0\">print</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Last gradient descent at guess_m = </span><span style=\"color: #EBCB8B\">{0}</span><span style=\"color: #A3BE8C\">, guess_b = </span><span style=\"color: #EBCB8B\">{1}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">.format</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    b</span>\n<span style=\"color: #ECEFF4\">))</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">Starting gradient descent at guess_m = 1.3450919020620442, guess_b = 6.687439682550092\nLast gradient descent at guess_m = 1.4510680203998683, guess_b = 1.4510195909326549</code>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #81A1C1\">def</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">compute_error_for_line</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9\">m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">b</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">points</span><span style=\"color: #ECEFF4\">):</span>\n<span style=\"color: #D8DEE9FF\">    total_error </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">0</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #4C566A\"># sum (y_i - y_hat_i) ^ 2</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">for</span><span style=\"color: #D8DEE9FF\"> i </span><span style=\"color: #81A1C1\">in</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">range</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> len</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">points</span><span style=\"color: #ECEFF4\">))</span><span style=\"color: #D8DEE9FF\">:</span>\n<span style=\"color: #D8DEE9FF\">        x </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> points</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">i, </span><span style=\"color: #B48EAD\">0</span><span style=\"color: #ECEFF4\">]</span>\n<span style=\"color: #D8DEE9FF\">        y </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> points</span><span style=\"color: #ECEFF4\">[</span><span style=\"color: #D8DEE9FF\">i, </span><span style=\"color: #B48EAD\">1</span><span style=\"color: #ECEFF4\">]</span>\n<span style=\"color: #D8DEE9FF\">        total_error </span><span style=\"color: #81A1C1\">+=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">y </span><span style=\"color: #81A1C1\">-</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #D8DEE9FF\">m </span><span style=\"color: #81A1C1\">*</span><span style=\"color: #D8DEE9FF\"> x </span><span style=\"color: #81A1C1\">+</span><span style=\"color: #D8DEE9FF\"> b</span><span style=\"color: #ECEFF4\">))</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">**</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #B48EAD\">2</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #4C566A\"># 1 / n</span>\n<span style=\"color: #D8DEE9FF\">    mse </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> total_error </span><span style=\"color: #81A1C1\">/</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">float</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">len</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">points</span><span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">return</span><span style=\"color: #D8DEE9FF\"> mse</span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #4C566A\"># lets see how bad our guess was</span>\n\n<span style=\"color: #88C0D0\">compute_error_for_line</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> data.values</span><span style=\"color: #ECEFF4\">)</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">838.9099083602013</code>\n<pre class=\"shiki\" style=\"background-color: #2e3440\"><code><span style=\"color: #88C0D0\">print</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Starting gradient descent at </span><span style=\"color: #EBCB8B\">\\n</span><span style=\"color: #A3BE8C\"> guess_m = </span><span style=\"color: #EBCB8B\">{0}</span><span style=\"color: #A3BE8C\">, guess_b = </span><span style=\"color: #EBCB8B\">{1}</span><span style=\"color: #A3BE8C\">, error </span><span style=\"color: #EBCB8B\">{2}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">.format</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    b_guess</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    compute_error_for_line</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b_guess</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> data.values</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #ECEFF4\">))</span>\n<span style=\"color: #88C0D0\">print</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #A3BE8C\">Last gradient descent at </span><span style=\"color: #EBCB8B\">\\n</span><span style=\"color: #A3BE8C\"> guess_m = </span><span style=\"color: #EBCB8B\">{0}</span><span style=\"color: #A3BE8C\">, guess_b = </span><span style=\"color: #EBCB8B\">{1}</span><span style=\"color: #A3BE8C\">, error </span><span style=\"color: #EBCB8B\">{2}</span><span style=\"color: #ECEFF4\">\"</span><span style=\"color: #88C0D0\">.format</span><span style=\"color: #ECEFF4\">(</span>\n<span style=\"color: #88C0D0\">    m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> </span>\n<span style=\"color: #88C0D0\">    b</span><span style=\"color: #ECEFF4\">,</span>\n<span style=\"color: #88C0D0\">    compute_error_for_line</span><span style=\"color: #ECEFF4\">(</span><span style=\"color: #88C0D0\">m</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> b</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #88C0D0\"> data.values</span><span style=\"color: #ECEFF4\">)</span>\n<span style=\"color: #ECEFF4\">))</span></code></pre>\n<code class=\"shiki\" style=\"background: #2e3440; color: #d8dee9\">Starting gradient descent at \n guess_m = 2, guess_b = 1, error 838.9099083602013\nLast gradient descent at \n guess_m = 1.4510680203998683, guess_b = 1.4510195909326549, error 111.87217648730648</code>\n<h1 id=\"how-does-gradient-descent-work\"><a href=\"#how-does-gradient-descent-work\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How does gradient descent work?</h1>\n<hr>\n<p>In it's most general form:</p>\n<p>Gradient descent is based on the observation that if the multi-variable function ${\\displaystyle F(\\mathbf {x} )}$ is defined and differentiable in a neighborhood of a point ${\\displaystyle \\mathbf {a} }$ , then ${\\displaystyle F(\\mathbf {x} )}$ decreases fastest if one goes from ${\\displaystyle \\mathbf {a} }$  in the direction of the negative gradient of ${\\displaystyle F}$ at ${\\displaystyle,-\\nabla F(\\mathbf {a} )}$. It follows that, if</p>\n<p>${\\displaystyle \\mathbf {a} <em>{n+1}=\\mathbf {a} </em>{n}-\\gamma \\nabla F(\\mathbf {a} _{n})}$</p>\n<p>for ${\\displaystyle \\gamma \\in \\mathbb {R} <em>{+}}$ small enough, then ${\\displaystyle F(\\mathbf {a</em>{n}} )\\geq F(\\mathbf {a_{n+1}} )}$. In other words, the term ${\\displaystyle \\gamma \\nabla F(\\mathbf {a} )}$ is subtracted from ${\\displaystyle \\mathbf {a} }$  because we want to move against the gradient, toward the minimum.</p>\n<p>Here we have defined and the algorith works with contraints:</p>\n<p><strong>learning rate</strong> ${\\gamma}$, for small ${\\displaystyle \\gamma \\in \\mathbb {R} _{+}}$</p>\n<p><strong>function</strong> $F(\\mathbf{x})$,  if differentiable; then ${\\displaystyle F(\\mathbf {a<em>{n}} )\\geq F(\\mathbf {a</em>{n+1}} )}$</p>\n<p><strong>Leading to</strong> ($\\leadsto $) a monotonic sequence $F(\\mathbf {x} <em>{0})\\geq F(\\mathbf {x} </em>{1})\\geq F(\\mathbf {x} _{2})\\geq \\cdots,$</p>\n<h1 id=\"coming-back-to-the-real-world\"><a href=\"#coming-back-to-the-real-world\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Coming back to the real world</h1>\n<p>Scikit learn provides you two approaches to linear regression:</p>\n<p>If you can decompose your loss function into additive terms, then stochastic approach is known to behave better (thus SGD) and if you can spare enough memory - OLS method is faster and easier (thus first solution).</p>\n<p>1) <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">LinearRegression</code> object uses <strong>Ordinary Least Squares</strong> solver from scipy, as LR is one of two classifiers which have closed form solution. Despite the ML course - you can actually learn this model by just inverting and multiplicating some matrices.</p>\n<p>2) <code class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\">SGDRegressor</code> which is an implementation of <strong>stochastic gradient descent</strong>, very generic one where you can choose your penalty terms. To obtain linear regression you choose loss to be L2 and penalty also to none (linear regression) or L2 (Ridge regression)</p>\n<p>The \"gradient descent\" is a major part of most learning algorithm. What you will see most often is a improved version of the algorithm <strong>Stochastic Gradient Descent</strong>.</p>\n<p>source - <a href=\"https://stackoverflow.com/questions/34469237/linear-regression-and-gradient-descent-in-scikit-learn-pandas\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">linear regression scitkit</a></p>\n"}}]}}},"context":{}}